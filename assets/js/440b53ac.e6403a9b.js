/*! For license information please see 440b53ac.e6403a9b.js.LICENSE.txt */
"use strict";(self.webpackChunkbuildbuddy_docs_website=self.webpackChunkbuildbuddy_docs_website||[]).push([[7847],{2525:function(e){var t=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable;function o(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},r=0;r<10;r++)t["_"+String.fromCharCode(r)]=r;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach((function(e){n[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(o){return!1}}()?Object.assign:function(e,i){for(var u,l,a=o(e),c=1;c<arguments.length;c++){for(var s in u=Object(arguments[c]))r.call(u,s)&&(a[s]=u[s]);if(t){l=t(u);for(var f=0;f<l.length;f++)n.call(u,l[f])&&(a[l[f]]=u[l[f]])}}return a}},1535:function(e,t,r){var n=r(2525),o="function"==typeof Symbol&&Symbol.for,i=o?Symbol.for("react.element"):60103,u=o?Symbol.for("react.portal"):60106,l=o?Symbol.for("react.fragment"):60107,a=o?Symbol.for("react.strict_mode"):60108,c=o?Symbol.for("react.profiler"):60114,s=o?Symbol.for("react.provider"):60109,f=o?Symbol.for("react.context"):60110,p=o?Symbol.for("react.forward_ref"):60112,d=o?Symbol.for("react.suspense"):60113,y=o?Symbol.for("react.memo"):60115,h=o?Symbol.for("react.lazy"):60116,b="function"==typeof Symbol&&Symbol.iterator;function w(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var k={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m={};function g(e,t,r){this.props=e,this.context=t,this.refs=m,this.updater=r||k}function v(){}function O(e,t,r){this.props=e,this.context=t,this.refs=m,this.updater=r||k}g.prototype.isReactComponent={},g.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error(w(85));this.updater.enqueueSetState(this,e,t,"setState")},g.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},v.prototype=g.prototype;var j=O.prototype=new v;j.constructor=O,n(j,g.prototype),j.isPureReactComponent=!0;var S={current:null},B=Object.prototype.hasOwnProperty,x={key:!0,ref:!0,__self:!0,__source:!0};function P(e,t,r){var n,o={},u=null,l=null;if(null!=t)for(n in void 0!==t.ref&&(l=t.ref),void 0!==t.key&&(u=""+t.key),t)B.call(t,n)&&!x.hasOwnProperty(n)&&(o[n]=t[n]);var a=arguments.length-2;if(1===a)o.children=r;else if(1<a){for(var c=Array(a),s=0;s<a;s++)c[s]=arguments[s+2];o.children=c}if(e&&e.defaultProps)for(n in a=e.defaultProps)void 0===o[n]&&(o[n]=a[n]);return{$$typeof:i,type:e,key:u,ref:l,props:o,_owner:S.current}}function N(e){return"object"==typeof e&&null!==e&&e.$$typeof===i}var C=/\/+/g,E=[];function _(e,t,r,n){if(E.length){var o=E.pop();return o.result=e,o.keyPrefix=t,o.func=r,o.context=n,o.count=0,o}return{result:e,keyPrefix:t,func:r,context:n,count:0}}function T(e){e.result=null,e.keyPrefix=null,e.func=null,e.context=null,e.count=0,10>E.length&&E.push(e)}function D(e,t,r,n){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var l=!1;if(null===e)l=!0;else switch(o){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case i:case u:l=!0}}if(l)return r(n,e,""===t?"."+U(e,0):t),1;if(l=0,t=""===t?".":t+":",Array.isArray(e))for(var a=0;a<e.length;a++){var c=t+U(o=e[a],a);l+=D(o,c,r,n)}else if(null===e||"object"!=typeof e?c=null:c="function"==typeof(c=b&&e[b]||e["@@iterator"])?c:null,"function"==typeof c)for(e=c.call(e),a=0;!(o=e.next()).done;)l+=D(o=o.value,c=t+U(o,a++),r,n);else if("object"===o)throw r=""+e,Error(w(31,"[object Object]"===r?"object with keys {"+Object.keys(e).join(", ")+"}":r,""));return l}function A(e,t,r){return null==e?0:D(e,"",t,r)}function U(e,t){return"object"==typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+(""+e).replace(/[=:]/g,(function(e){return t[e]}))}(e.key):t.toString(36)}function q(e,t){e.func.call(e.context,t,e.count++)}function W(e,t,r){var n=e.result,o=e.keyPrefix;e=e.func.call(e.context,t,e.count++),Array.isArray(e)?$(e,n,r,(function(e){return e})):null!=e&&(N(e)&&(e=function(e,t){return{$$typeof:i,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(e,o+(!e.key||t&&t.key===e.key?"":(""+e.key).replace(C,"$&/")+"/")+r)),n.push(e))}function $(e,t,r,n,o){var i="";null!=r&&(i=(""+r).replace(C,"$&/")+"/"),A(e,W,t=_(t,i,n,o)),T(t)}var G={current:null};function H(){var e=G.current;if(null===e)throw Error(w(321));return e}},7378:function(e,t,r){r(1535)},4137:function(e,t,r){r.d(t,{Zo:function(){return s},kt:function(){return d}});var n=r(7294);function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){o(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var a=n.createContext({}),c=function(e){var t=n.useContext(a),r=t;return e&&(r="function"==typeof e?e(t):u(u({},t),e)),r},s=function(e){var t=c(e.components);return n.createElement(a.Provider,{value:t},e.children)},f={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},p=n.forwardRef((function(e,t){var r=e.components,o=e.mdxType,i=e.originalType,a=e.parentName,s=l(e,["components","mdxType","originalType","parentName"]),p=c(r),d=o,y=p["".concat(a,".").concat(d)]||p[d]||f[d]||i;return r?n.createElement(y,u(u({ref:t},s),{},{components:r})):n.createElement(y,u({ref:t},s))}));function d(e,t){var r=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var i=r.length,u=new Array(i);u[0]=p;var l={};for(var a in t)hasOwnProperty.call(t,a)&&(l[a]=t[a]);l.originalType=e,l.mdxType="string"==typeof e?e:o,u[1]=l;for(var c=2;c<i;c++)u[c]=r[c];return n.createElement.apply(null,u)}return n.createElement.apply(null,r)}p.displayName="MDXCreateElement"},2677:function(e,t,r){r.r(t),r.d(t,{frontMatter:function(){return l},contentTitle:function(){return a},metadata:function(){return c},toc:function(){return s},default:function(){return p}});var n=r(7462),o=r(3366),i=(r(7378),r(4137)),u=["components"],l={id:"workflows-setup",title:"Workflows setup",sidebar_label:"Workflows setup"},a=void 0,c={unversionedId:"workflows-setup",id:"workflows-setup",title:"Workflows setup",description:"Workflows automatically build and test your code with",source:"@site/../docs/workflows-setup.md",sourceDirName:".",slug:"/workflows-setup",permalink:"/docs/workflows-setup",editUrl:"https://github.com/buildbuddy-io/buildbuddy/edit/master/docs/../docs/workflows-setup.md",tags:[],version:"current",lastUpdatedBy:"Brandon Duffany",lastUpdatedAt:1668187622,formattedLastUpdatedAt:"11/11/2022",frontMatter:{id:"workflows-setup",title:"Workflows setup",sidebar_label:"Workflows setup"},sidebar:"someSidebar",previous:{title:"Workflows introduction",permalink:"/docs/workflows-introduction"},next:{title:"Workflows configuration",permalink:"/docs/workflows-config"}},s=[{value:"Enable workflows for a repo",id:"enable-workflows-for-a-repo",children:[{value:"1. Link GitHub account",id:"1-link-github-account",children:[],level:3},{value:"2. Link the repository",id:"2-link-the-repository",children:[],level:3}],level:2},{value:"Configuring your workflow",id:"configuring-your-workflow",children:[],level:2},{value:"Setting up branch protection rules",id:"setting-up-branch-protection-rules",children:[],level:2},{value:"Building in the workflow runner environment",id:"building-in-the-workflow-runner-environment",children:[],level:2}],f={toc:s};function p(e){var t=e.components,r=(0,o.Z)(e,u);return(0,i.kt)("wrapper",(0,n.Z)({},f,r,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"Workflows automatically build and test your code with\nBuildBuddy whenever a commit is pushed to your GitHub repo."),(0,i.kt)("p",null,"When combined with GitHub's branch protection rules, workflows can help prevent\nunwanted code (that doesn't build or pass tests) from being merged into the main branch."),(0,i.kt)("p",null,"Best of all, workflows let you run any Bazel commands you would like,\nso you can leverage all the same BuildBuddy features that you get when\nrunning Bazel locally, like the results UI, remote caching, remote execution."),(0,i.kt)("h2",{id:"enable-workflows-for-a-repo"},"Enable workflows for a repo"),(0,i.kt)("h3",{id:"1-link-github-account"},"1. Link GitHub account"),(0,i.kt)("p",null,'If you use GitHub, make sure that your BuildBuddy org has a GitHub\norg linked to it, using the "Link GitHub account" button from the\nsettings page.'),(0,i.kt)("h3",{id:"2-link-the-repository"},"2. Link the repository"),(0,i.kt)("p",null,"Click ",(0,i.kt)("strong",{parentName:"p"},"Workflows")," in the BuildBuddy app and select a repo to\nbe linked to BuildBuddy."),(0,i.kt)("p",null,"Then, BuildBuddy will run ",(0,i.kt)("inlineCode",{parentName:"p"},"bazel test //...")," whenever a commit is pushed to\nyour repo. It reports the status of the test as well as BuildBuddy links to\nGitHub, which you can see on the repo's home page or in pull request branches."),(0,i.kt)("h2",{id:"configuring-your-workflow"},"Configuring your workflow"),(0,i.kt)("p",null,"To learn how to change the default configuration, see ",(0,i.kt)("a",{parentName:"p",href:"/docs/workflows-config"},"workflows configuration"),"."),(0,i.kt)("h2",{id:"setting-up-branch-protection-rules"},"Setting up branch protection rules"),(0,i.kt)("p",null,"After you have created a workflow and you've pushed at least one commit\nto the repo, you can configure your repo so that branches cannot be\nmerged unless the workflow succeeds."),(0,i.kt)("p",null,"To do this, go to ",(0,i.kt)("strong",{parentName:"p"},"Settings")," > ",(0,i.kt)("strong",{parentName:"p"},"Branches")," and find ",(0,i.kt)("strong",{parentName:"p"},"Branch protection rules"),".\nThen, you click ",(0,i.kt)("strong",{parentName:"p"},"Add rule")," (or edit an existing rule)."),(0,i.kt)("p",null,"Select the box ",(0,i.kt)("strong",{parentName:"p"},"Require status checks to pass before merging")," and enable\nthe check corresponding to the BuildBuddy workflow (by default, this should\nbe ",(0,i.kt)("strong",{parentName:"p"},"Test all targets"),")."),(0,i.kt)("p",null,"After you save your changes, pull requests will not be mergeable unless\nthe tests pass on BuildBuddy."),(0,i.kt)("h2",{id:"building-in-the-workflow-runner-environment"},"Building in the workflow runner environment"),(0,i.kt)("p",null,"BuildBuddy workflows execute using Docker on a recent Ubuntu base image\n(Ubuntu 18.04 at the time of this writing), with some commonly used tools\nand libraries pre-installed."),(0,i.kt)("p",null,"If you would like to test whether your build will succeed with\nBuildBuddy workflows without having to set up and trigger the workflow,\nyou can instead run the image with Docker, clone your Git repo, and invoke\n",(0,i.kt)("inlineCode",{parentName:"p"},"bazel")," to run your tests."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},'# Start a new shell inside the workflows environment (requires docker)\ndocker run --rm -it "gcr.io/flame-public/buildbuddy-ci-runner:latest"\n\n# Clone your repo and test it\ngit clone https://github.com/acme-inc/acme\ncd acme\nbazel test //...\n')),(0,i.kt)("p",null,"The Dockerfile we use to build the image (at ",(0,i.kt)("inlineCode",{parentName:"p"},"HEAD"),") is ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/buildbuddy-io/buildbuddy/blob/master/enterprise/dockerfiles/ci_runner_image/Dockerfile"},"here"),"."))}p.isMDXComponent=!0}}]);