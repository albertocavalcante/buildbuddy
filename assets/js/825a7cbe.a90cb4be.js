/*! For license information please see 825a7cbe.a90cb4be.js.LICENSE.txt */
"use strict";(self.webpackChunkbuildbuddy_docs_website=self.webpackChunkbuildbuddy_docs_website||[]).push([[941],{2525:function(e){var t=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable;function o(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},r=0;r<10;r++)t["_"+String.fromCharCode(r)]=r;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach((function(e){n[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(o){return!1}}()?Object.assign:function(e,i){for(var a,s,c=o(e),l=1;l<arguments.length;l++){for(var u in a=Object(arguments[l]))r.call(a,u)&&(c[u]=a[u]);if(t){s=t(a);for(var d=0;d<s.length;d++)n.call(a,s[d])&&(c[s[d]]=a[s[d]])}}return c}},1535:function(e,t,r){var n=r(2525),o="function"==typeof Symbol&&Symbol.for,i=o?Symbol.for("react.element"):60103,a=o?Symbol.for("react.portal"):60106,s=o?Symbol.for("react.fragment"):60107,c=o?Symbol.for("react.strict_mode"):60108,l=o?Symbol.for("react.profiler"):60114,u=o?Symbol.for("react.provider"):60109,d=o?Symbol.for("react.context"):60110,p=o?Symbol.for("react.forward_ref"):60112,f=o?Symbol.for("react.suspense"):60113,y=o?Symbol.for("react.memo"):60115,h=o?Symbol.for("react.lazy"):60116,m="function"==typeof Symbol&&Symbol.iterator;function b(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g={};function k(e,t,r){this.props=e,this.context=t,this.refs=g,this.updater=r||v}function w(){}function S(e,t,r){this.props=e,this.context=t,this.refs=g,this.updater=r||v}k.prototype.isReactComponent={},k.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error(b(85));this.updater.enqueueSetState(this,e,t,"setState")},k.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},w.prototype=k.prototype;var O=S.prototype=new w;O.constructor=S,n(O,k.prototype),O.isPureReactComponent=!0;var j={current:null},x=Object.prototype.hasOwnProperty,N={key:!0,ref:!0,__self:!0,__source:!0};function P(e,t,r){var n,o={},a=null,s=null;if(null!=t)for(n in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(a=""+t.key),t)x.call(t,n)&&!N.hasOwnProperty(n)&&(o[n]=t[n]);var c=arguments.length-2;if(1===c)o.children=r;else if(1<c){for(var l=Array(c),u=0;u<c;u++)l[u]=arguments[u+2];o.children=l}if(e&&e.defaultProps)for(n in c=e.defaultProps)void 0===o[n]&&(o[n]=c[n]);return{$$typeof:i,type:e,key:a,ref:s,props:o,_owner:j.current}}function B(e){return"object"==typeof e&&null!==e&&e.$$typeof===i}var _=/\/+/g,E=[];function C(e,t,r,n){if(E.length){var o=E.pop();return o.result=e,o.keyPrefix=t,o.func=r,o.context=n,o.count=0,o}return{result:e,keyPrefix:t,func:r,context:n,count:0}}function T(e){e.result=null,e.keyPrefix=null,e.func=null,e.context=null,e.count=0,10>E.length&&E.push(e)}function z(e,t,r,n){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var s=!1;if(null===e)s=!0;else switch(o){case"string":case"number":s=!0;break;case"object":switch(e.$$typeof){case i:case a:s=!0}}if(s)return r(n,e,""===t?"."+D(e,0):t),1;if(s=0,t=""===t?".":t+":",Array.isArray(e))for(var c=0;c<e.length;c++){var l=t+D(o=e[c],c);s+=z(o,l,r,n)}else if(null===e||"object"!=typeof e?l=null:l="function"==typeof(l=m&&e[m]||e["@@iterator"])?l:null,"function"==typeof l)for(e=l.call(e),c=0;!(o=e.next()).done;)s+=z(o=o.value,l=t+D(o,c++),r,n);else if("object"===o)throw r=""+e,Error(b(31,"[object Object]"===r?"object with keys {"+Object.keys(e).join(", ")+"}":r,""));return s}function A(e,t,r){return null==e?0:z(e,"",t,r)}function D(e,t){return"object"==typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+(""+e).replace(/[=:]/g,(function(e){return t[e]}))}(e.key):t.toString(36)}function $(e,t){e.func.call(e.context,t,e.count++)}function q(e,t,r){var n=e.result,o=e.keyPrefix;e=e.func.call(e.context,t,e.count++),Array.isArray(e)?U(e,n,r,(function(e){return e})):null!=e&&(B(e)&&(e=function(e,t){return{$$typeof:i,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(e,o+(!e.key||t&&t.key===e.key?"":(""+e.key).replace(_,"$&/")+"/")+r)),n.push(e))}function U(e,t,r,n,o){var i="";null!=r&&(i=(""+r).replace(_,"$&/")+"/"),A(e,q,t=C(t,i,n,o)),T(t)}var W={current:null};function M(){var e=W.current;if(null===e)throw Error(b(321));return e}},7378:function(e,t,r){r(1535)},4137:function(e,t,r){r.d(t,{Zo:function(){return u},kt:function(){return f}});var n=r(7294);function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){o(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var c=n.createContext({}),l=function(e){var t=n.useContext(c),r=t;return e&&(r="function"==typeof e?e(t):a(a({},t),e)),r},u=function(e){var t=l(e.components);return n.createElement(c.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},p=n.forwardRef((function(e,t){var r=e.components,o=e.mdxType,i=e.originalType,c=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),p=l(r),f=o,y=p["".concat(c,".").concat(f)]||p[f]||d[f]||i;return r?n.createElement(y,a(a({ref:t},u),{},{components:r})):n.createElement(y,a({ref:t},u))}));function f(e,t){var r=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var i=r.length,a=new Array(i);a[0]=p;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s.mdxType="string"==typeof e?e:o,a[1]=s;for(var l=2;l<i;l++)a[l]=r[l];return n.createElement.apply(null,a)}return n.createElement.apply(null,r)}p.displayName="MDXCreateElement"},826:function(e,t,r){r.r(t),r.d(t,{frontMatter:function(){return s},contentTitle:function(){return c},metadata:function(){return l},toc:function(){return u},default:function(){return p}});var n=r(7462),o=r(3366),i=(r(7378),r(4137)),a=["components"],s={id:"secrets",title:"Secrets",sidebar_label:"Secrets"},c=void 0,l={unversionedId:"secrets",id:"secrets",title:"Secrets",description:"Secrets are encrypted environment variables associated with your",source:"@site/../docs/secrets.md",sourceDirName:".",slug:"/secrets",permalink:"/docs/secrets",editUrl:"https://github.com/buildbuddy-io/buildbuddy/edit/master/docs/../docs/secrets.md",tags:[],version:"current",lastUpdatedBy:"Tyler Williams",lastUpdatedAt:1667871632,formattedLastUpdatedAt:"11/8/2022",frontMatter:{id:"secrets",title:"Secrets",sidebar_label:"Secrets"}},u=[{value:"Why use secrets?",id:"why-use-secrets",children:[],level:2},{value:"Defining secrets",id:"defining-secrets",children:[],level:2},{value:"Getting secret values",id:"getting-secret-values",children:[{value:"Bazel actions",id:"bazel-actions",children:[],level:3},{value:"Workflows",id:"workflows",children:[],level:3}],level:2},{value:"Security notes",id:"security-notes",children:[],level:2}],d={toc:u};function p(e){var t=e.components,r=(0,o.Z)(e,a);return(0,i.kt)("wrapper",(0,n.Z)({},d,r,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"Secrets are encrypted environment variables associated with your\nBuildBuddy organization. Secrets can be used in actions executed with\n",(0,i.kt)("a",{parentName:"p",href:"remote-build-execution"},"remote execution")," as well as ",(0,i.kt)("a",{parentName:"p",href:"workflows-introduction"},"BuildBuddy\nWorkflows"),"."),(0,i.kt)("p",null,"BuildBuddy encrypts secrets with a\n",(0,i.kt)("a",{parentName:"p",href:"https://libsodium.gitbook.io/doc/public-key_cryptography/sealed_boxes"},"libsodium sealed box"),".\nSecrets are encrypted before they are sent to BuildBuddy's\nservers, and stay encrypted until they are used."),(0,i.kt)("h2",{id:"why-use-secrets"},"Why use secrets?"),(0,i.kt)("p",null,"Builds that are executed remotely on BuildBuddy's servers may occasionally\nneed access to an API key or other credentials. For example, you may want\nto ",(0,i.kt)("a",{parentName:"p",href:"rbe-platforms#passing-credentials-for-docker-images"},"pass credentials for a Docker image"),"."),(0,i.kt)("p",null,"Storing these sensitive parameters as plain environment variables is\nundesirable because those keys would be stored unencrypted in BuildBuddy's\nAction Cache. While BuildBuddy's cache requires authorization and is secured\nusing TLS, storing so many copies of the secret in cache increases attack\nsurface and increases the chance of accidentally exposing your own\ncredentials."),(0,i.kt)("p",null,"Secrets solve this problem by allowing sensitive keys to be stored in\nencrypted format separately from the actions themselves."),(0,i.kt)("h2",{id:"defining-secrets"},"Defining secrets"),(0,i.kt)("p",null,"Secrets can be added to your organization using the Secrets page in\n",(0,i.kt)("a",{parentName:"p",href:"https://app.buildbuddy.io/settings/org/secrets"},"settings"),"."),(0,i.kt)("p",null,"Secrets can be edited or deleted using the Secrets page. Once a secret\nis saved, its currently stored value cannot be viewed using the Secrets\npage."),(0,i.kt)("h2",{id:"getting-secret-values"},"Getting secret values"),(0,i.kt)("h3",{id:"bazel-actions"},"Bazel actions"),(0,i.kt)("p",null,"To opt a specific action into secrets, you can define the remote exec\nproperty ",(0,i.kt)("inlineCode",{parentName:"p"},"include-secrets=true"),". We recommend doing this per-action to\navoid exposing secrets to actions that do not need them."),(0,i.kt)("p",null,"Example:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-python"},'foo_library(\n    # ...\n    exec_properties = {\n        "include-secrets": "true",\n    }\n)\n')),(0,i.kt)("h3",{id:"workflows"},"Workflows"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"workflows-introduction"},"BuildBuddy workflows")," do not need additional\nconfiguration to use secrets; they receive secrets by default as long as\nthe workflow is being triggered on behalf of a trusted collaborator in the\nrepository."),(0,i.kt)("p",null,"Workflow secrets are accessed via environment variables, in the same way\nas normal Bazel actions shown above."),(0,i.kt)("h2",{id:"security-notes"},"Security notes"),(0,i.kt)("p",null,"Secrets are encrypted on the client-side using\n",(0,i.kt)("a",{parentName:"p",href:"https://doc.libsodium.org/"},"libsodium"),", which is based on\n",(0,i.kt)("a",{parentName:"p",href:"http://nacl.cr.yp.to/"},"NaCl"),"."),(0,i.kt)("p",null,"The public key used to encrypt secrets is unique to each organization. The\nprivate key used to decrypt secrets is stored encrypted and only decrypted\nwhen used to unseal secrets."),(0,i.kt)("p",null,"Secrets are only stored in their encrypted form and are decrypted\non-demand for actions that opt in to receiving secrets."),(0,i.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"Avoid printing secret values to your build logs or action outputs."))))}p.isMDXComponent=!0}}]);