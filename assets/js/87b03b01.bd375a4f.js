/*! For license information please see 87b03b01.bd375a4f.js.LICENSE.txt */
"use strict";(self.webpackChunkbuildbuddy_docs_website=self.webpackChunkbuildbuddy_docs_website||[]).push([[9691],{2525:function(e){var t=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable;function o(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(e){r[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(o){return!1}}()?Object.assign:function(e,i){for(var a,l,c=o(e),u=1;u<arguments.length;u++){for(var s in a=Object(arguments[u]))n.call(a,s)&&(c[s]=a[s]);if(t){l=t(a);for(var p=0;p<l.length;p++)r.call(a,l[p])&&(c[l[p]]=a[l[p]])}}return c}},1535:function(e,t,n){var r=n(2525),o="function"==typeof Symbol&&Symbol.for,i=o?Symbol.for("react.element"):60103,a=o?Symbol.for("react.portal"):60106,l=o?Symbol.for("react.fragment"):60107,c=o?Symbol.for("react.strict_mode"):60108,u=o?Symbol.for("react.profiler"):60114,s=o?Symbol.for("react.provider"):60109,p=o?Symbol.for("react.context"):60110,f=o?Symbol.for("react.forward_ref"):60112,d=o?Symbol.for("react.suspense"):60113,m=o?Symbol.for("react.memo"):60115,y=o?Symbol.for("react.lazy"):60116,h="function"==typeof Symbol&&Symbol.iterator;function b(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var g={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},k={};function v(e,t,n){this.props=e,this.context=t,this.refs=k,this.updater=n||g}function x(){}function O(e,t,n){this.props=e,this.context=t,this.refs=k,this.updater=n||g}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error(b(85));this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},x.prototype=v.prototype;var w=O.prototype=new x;w.constructor=O,r(w,v.prototype),w.isPureReactComponent=!0;var _={current:null},N=Object.prototype.hasOwnProperty,j={key:!0,ref:!0,__self:!0,__source:!0};function S(e,t,n){var r,o={},a=null,l=null;if(null!=t)for(r in void 0!==t.ref&&(l=t.ref),void 0!==t.key&&(a=""+t.key),t)N.call(t,r)&&!j.hasOwnProperty(r)&&(o[r]=t[r]);var c=arguments.length-2;if(1===c)o.children=n;else if(1<c){for(var u=Array(c),s=0;s<c;s++)u[s]=arguments[s+2];o.children=u}if(e&&e.defaultProps)for(r in c=e.defaultProps)void 0===o[r]&&(o[r]=c[r]);return{$$typeof:i,type:e,key:a,ref:l,props:o,_owner:_.current}}function E(e){return"object"==typeof e&&null!==e&&e.$$typeof===i}var C=/\/+/g,P=[];function M(e,t,n,r){if(P.length){var o=P.pop();return o.result=e,o.keyPrefix=t,o.func=n,o.context=r,o.count=0,o}return{result:e,keyPrefix:t,func:n,context:r,count:0}}function T(e){e.result=null,e.keyPrefix=null,e.func=null,e.context=null,e.count=0,10>P.length&&P.push(e)}function B(e,t,n,r){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var l=!1;if(null===e)l=!0;else switch(o){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case i:case a:l=!0}}if(l)return n(r,e,""===t?"."+A(e,0):t),1;if(l=0,t=""===t?".":t+":",Array.isArray(e))for(var c=0;c<e.length;c++){var u=t+A(o=e[c],c);l+=B(o,u,n,r)}else if(null===e||"object"!=typeof e?u=null:u="function"==typeof(u=h&&e[h]||e["@@iterator"])?u:null,"function"==typeof u)for(e=u.call(e),c=0;!(o=e.next()).done;)l+=B(o=o.value,u=t+A(o,c++),n,r);else if("object"===o)throw n=""+e,Error(b(31,"[object Object]"===n?"object with keys {"+Object.keys(e).join(", ")+"}":n,""));return l}function R(e,t,n){return null==e?0:B(e,"",t,n)}function A(e,t){return"object"==typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+(""+e).replace(/[=:]/g,(function(e){return t[e]}))}(e.key):t.toString(36)}function D(e,t){e.func.call(e.context,t,e.count++)}function Y(e,t,n){var r=e.result,o=e.keyPrefix;e=e.func.call(e.context,t,e.count++),Array.isArray(e)?U(e,r,n,(function(e){return e})):null!=e&&(E(e)&&(e=function(e,t){return{$$typeof:i,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(e,o+(!e.key||t&&t.key===e.key?"":(""+e.key).replace(C,"$&/")+"/")+n)),r.push(e))}function U(e,t,n,r,o){var i="";null!=n&&(i=(""+n).replace(C,"$&/")+"/"),R(e,Y,t=M(t,i,r,o)),T(t)}var F={current:null};function $(){var e=F.current;if(null===e)throw Error(b(321));return e}},7378:function(e,t,n){n(1535)},4137:function(e,t,n){n.d(t,{Zo:function(){return s},kt:function(){return d}});var r=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var c=r.createContext({}),u=function(e){var t=r.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},s=function(e){var t=u(e.components);return r.createElement(c.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},f=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,i=e.originalType,c=e.parentName,s=l(e,["components","mdxType","originalType","parentName"]),f=u(n),d=o,m=f["".concat(c,".").concat(d)]||f[d]||p[d]||i;return n?r.createElement(m,a(a({ref:t},s),{},{components:n})):r.createElement(m,a({ref:t},s))}));function d(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var i=n.length,a=new Array(i);a[0]=f;var l={};for(var c in t)hasOwnProperty.call(t,c)&&(l[c]=t[c]);l.originalType=e,l.mdxType="string"==typeof e?e:o,a[1]=l;for(var u=2;u<i;u++)a[u]=n[u];return r.createElement.apply(null,a)}return r.createElement.apply(null,n)}f.displayName="MDXCreateElement"},7586:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return l},contentTitle:function(){return c},metadata:function(){return u},toc:function(){return s},default:function(){return f}});var r=n(7462),o=n(3366),i=(n(7378),n(4137)),a=["components"],l={id:"config-rbe",title:"RBE Configuration",sidebar_label:"RBE"},c=void 0,u={unversionedId:"config-rbe",id:"config-rbe",title:"RBE Configuration",description:"Remote Build Execution is only configurable in the Enterprise version of BuildBuddy.",source:"@site/../docs/config-rbe.md",sourceDirName:".",slug:"/config-rbe",permalink:"/docs/config-rbe",editUrl:"https://github.com/buildbuddy-io/buildbuddy/edit/master/docs/../docs/config-rbe.md",tags:[],version:"current",lastUpdatedBy:"Siggi Simonarson",lastUpdatedAt:1668458972,formattedLastUpdatedAt:"11/14/2022",frontMatter:{id:"config-rbe",title:"RBE Configuration",sidebar_label:"RBE"},sidebar:"someSidebar",previous:{title:"Org",permalink:"/docs/config-org"},next:{title:"Misc",permalink:"/docs/config-misc"}},s=[{value:"Section",id:"section",children:[],level:2},{value:"Options",id:"options",children:[],level:2},{value:"Example section",id:"example-section",children:[],level:2},{value:"Executor config",id:"executor-config",children:[{value:"Container registry authentication",id:"container-registry-authentication",children:[],level:3}],level:2},{value:"Executor environment variables",id:"executor-environment-variables",children:[],level:2}],p={toc:s};function f(e){var t=e.components,n=(0,o.Z)(e,a);return(0,i.kt)("wrapper",(0,r.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"Remote Build Execution is only configurable in the ",(0,i.kt)("a",{parentName:"p",href:"/docs/enterprise"},"Enterprise version")," of BuildBuddy."),(0,i.kt)("p",null,"RBE configuration must be enabled in your ",(0,i.kt)("inlineCode",{parentName:"p"},"config.yaml")," file, but most configuration is done via ",(0,i.kt)("a",{parentName:"p",href:"/docs/rbe-setup"},"toolchains"),", ",(0,i.kt)("a",{parentName:"p",href:"/docs/rbe-platforms"},"platforms"),", or the ",(0,i.kt)("a",{parentName:"p",href:"enterprise-helm"},"enterprise Helm chart"),"."),(0,i.kt)("h2",{id:"section"},"Section"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"remote_execution:")," The remote_execution section allows you to configure BuildBuddy's remote build execution. ",(0,i.kt)("strong",{parentName:"p"},"Optional")),(0,i.kt)("h2",{id:"options"},"Options"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Optional")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"enable_remote_exec:")," True if remote execution should be enabled."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"default_pool_name:")," The default executor pool to use if one is not specified.")),(0,i.kt)("h2",{id:"example-section"},"Example section"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},"remote_execution:\n  enable_remote_exec: true\n")),(0,i.kt)("h2",{id:"executor-config"},"Executor config"),(0,i.kt)("p",null,"BuildBuddy RBE executors take their own configuration file that is pulled from ",(0,i.kt)("inlineCode",{parentName:"p"},"/config.yaml")," on the executor docker image. Using BuildBuddy's ",(0,i.kt)("a",{parentName:"p",href:"/docs/enterprise-helm"},"Enterprise Helm chart")," will take care of most of this configuration for you."),(0,i.kt)("p",null,"Here is an example:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},'executor:\n  app_target: "grpcs://your.buildbuddy.install:443"\n  root_directory: "/buildbuddy/remotebuilds/"\n  local_cache_directory: "/buildbuddy/filecache/"\n  local_cache_size_bytes: 5000000000 # 5GB\n  docker_socket: /var/run/docker.sock\n')),(0,i.kt)("h3",{id:"container-registry-authentication"},"Container registry authentication"),(0,i.kt)("p",null,"By default, executors will respect the container registry configuration in\n",(0,i.kt)("inlineCode",{parentName:"p"},"~/.docker/config.json"),". The format of this file is described ",(0,i.kt)("a",{parentName:"p",href:"https://docs.docker.com/engine/reference/commandline/login/"},"here"),".\nAny credential helpers configured there will be respected."),(0,i.kt)("p",null,"For convenience, per-registry credentials can also be statically configured\nin the executor config YAML. These credentials will take priority over the\nconfiguration in ",(0,i.kt)("inlineCode",{parentName:"p"},"~/.docker/config.json"),"."),(0,i.kt)("p",null,"Here is an example:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},'executor:\n  container_registries:\n    - hostnames:\n        - "my-private-registry.io"\n        - "subdomain.my-private-registry.io"\n      username: "registry-username"\n      password: "registry-password-or-long-lived-token"\n')),(0,i.kt)("p",null,"This is especially useful for registries that allow using static tokens\nfor authentication, which avoids the need to set up credential helpers."),(0,i.kt)("p",null,'For example, Google Container Registry allows setting a username of\n"',"_",'json_key" and then passing the service account key directly:'),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},'executor:\n  container_registries:\n    - hostnames:\n        - "gcr.io"\n        - "marketplace.gcr.io"\n      username: "_json_key"\n      # Note: the YAML multiline string syntax ">" is used to embed the\n      # key JSON as a raw string. Be sure to indent as shown below:\n      password: >\n        {\n          "type": "service_account",\n          "project_id": my-project-id",\n          "private_key_id": "...",\n          "private_key": "...",\n          // More fields omitted\n          ...\n        }\n')),(0,i.kt)("h2",{id:"executor-environment-variables"},"Executor environment variables"),(0,i.kt)("p",null,"In addition to the config.yaml, there are also environment variables that executors consume. To get more information about their environment. All of these are optional, but can be useful for more complex configurations."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"SYS_MEMORY_BYTES"),": The amount of memory (in bytes) that this executor is allowed to consume. Defaults to free system memory."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"SYS_MILLICPU"),": The amount of CPU (in millicpus) that this executor is allowed to consume. Defaults to system CPU."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"MY_NODENAME"),": The name of the machine/node that the executor is running on. Defaults to empty string."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"MY_HOSTNAME"),": The hostname by which the app can communicate to this executor. Defaults to machine hostname."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"MY_PORT"),": The port over which the app can communicate with this executor. Defaults to the executor's gRPC port."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"MY_POOL"),": The executor pool that this executor should be placed in. Defaults to empty string.")),(0,i.kt)("p",null,"Many of these environment variables are typically set based on Kubernetes FieldRefs like so:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},"env:\n  - name: SYS_MEMORY_BYTES\n    valueFrom:\n      resourceFieldRef:\n        resource: limits.memory\n  - name: SYS_MILLICPU\n    valueFrom:\n      resourceFieldRef:\n        resource: limits.cpu\n  - name: MY_HOSTNAME\n    valueFrom:\n      fieldRef:\n        fieldPath: status.podIP\n  - name: MY_NODENAME\n    valueFrom:\n      fieldRef:\n        fieldPath: spec.nodeName\n")))}f.isMDXComponent=!0}}]);