load("@io_bazel_rules_go//go:def.bzl", "go_library", "go_test")

go_library(
    name = "xdsresource",
    srcs = [
        "cluster_resource_type.go",
        "endpoints_resource_type.go",
        "errors.go",
        "filter_chain.go",
        "listener_resource_type.go",
        "logging.go",
        "matcher.go",
        "matcher_path.go",
        "name.go",
        "resource_type.go",
        "route_config_resource_type.go",
        "type.go",
        "type_cds.go",
        "type_eds.go",
        "type_lds.go",
        "type_rds.go",
        "unmarshal_cds.go",
        "unmarshal_eds.go",
        "unmarshal_lds.go",
        "unmarshal_rds.go",
    ],
    importpath = "google.golang.org/grpc/xds/internal/xdsclient/xdsresource",
    visibility = ["//xds:__subpackages__"],
    deps = [
        "//codes",
        "//grpclog",
        "//internal/envconfig",
        "//internal/grpclog",
        "//internal/grpcrand",
        "//internal/grpcutil",
        "//internal/pretty",
        "//internal/resolver",
        "//internal/serviceconfig",
        "//internal/xds/matcher",
        "//metadata",
        "//xds/internal",
        "//xds/internal/clusterspecifier",
        "//xds/internal/httpfilter",
        "//xds/internal/xdsclient/bootstrap",
        "//xds/internal/xdsclient/xdslbregistry",
        "//xds/internal/xdsclient/xdsresource/version",
        "@com_github_cncf_udpa_go//udpa/type/v1:type",
        "@com_github_cncf_xds_go//xds/type/v3:type",
        "@com_github_envoyproxy_go_control_plane//envoy/config/cluster/v3:cluster",
        "@com_github_envoyproxy_go_control_plane//envoy/config/core/v3:core",
        "@com_github_envoyproxy_go_control_plane//envoy/config/endpoint/v3:endpoint",
        "@com_github_envoyproxy_go_control_plane//envoy/config/listener/v3:listener",
        "@com_github_envoyproxy_go_control_plane//envoy/config/route/v3:route",
        "@com_github_envoyproxy_go_control_plane//envoy/extensions/clusters/aggregate/v3:aggregate",
        "@com_github_envoyproxy_go_control_plane//envoy/extensions/filters/network/http_connection_manager/v3:http_connection_manager",
        "@com_github_envoyproxy_go_control_plane//envoy/extensions/transport_sockets/tls/v3:tls",
        "@com_github_envoyproxy_go_control_plane//envoy/service/discovery/v3:discovery",
        "@com_github_envoyproxy_go_control_plane//envoy/type/v3:type",
        "@com_github_golang_protobuf//proto:go_default_library",
        "@com_github_golang_protobuf//ptypes:go_default_library_gen",
        "@org_golang_google_protobuf//proto",
        "@org_golang_google_protobuf//types/known/anypb",
    ],
)

alias(
    name = "go_default_library",
    actual = ":xdsresource",
    visibility = ["//xds:__subpackages__"],
)

go_test(
    name = "xdsresource_test",
    srcs = [
        "filter_chain_test.go",
        "matcher_path_test.go",
        "matcher_test.go",
        "name_test.go",
        "test_utils_test.go",
        "unmarshal_cds_test.go",
        "unmarshal_eds_test.go",
        "unmarshal_lds_test.go",
        "unmarshal_rds_test.go",
    ],
    embed = [":xdsresource"],
    deps = [
        "//codes",
        "//internal/envconfig",
        "//internal/grpcrand",
        "//internal/grpctest",
        "//internal/grpcutil",
        "//internal/pretty",
        "//internal/resolver",
        "//internal/testutils",
        "//internal/testutils/xds/e2e",
        "//internal/xds/matcher",
        "//metadata",
        "//xds/internal",
        "//xds/internal/clusterspecifier",
        "//xds/internal/httpfilter",
        "//xds/internal/httpfilter/rbac",
        "//xds/internal/httpfilter/router",
        "//xds/internal/xdsclient/xdsresource/version",
        "@com_github_cncf_udpa_go//udpa/type/v1:type",
        "@com_github_cncf_xds_go//xds/type/v3:type",
        "@com_github_envoyproxy_go_control_plane//envoy/api/v2:api",
        "@com_github_envoyproxy_go_control_plane//envoy/config/cluster/v3:cluster",
        "@com_github_envoyproxy_go_control_plane//envoy/config/core/v3:core",
        "@com_github_envoyproxy_go_control_plane//envoy/config/endpoint/v3:endpoint",
        "@com_github_envoyproxy_go_control_plane//envoy/config/listener/v3:listener",
        "@com_github_envoyproxy_go_control_plane//envoy/config/rbac/v3:rbac",
        "@com_github_envoyproxy_go_control_plane//envoy/config/route/v3:route",
        "@com_github_envoyproxy_go_control_plane//envoy/extensions/clusters/aggregate/v3:aggregate",
        "@com_github_envoyproxy_go_control_plane//envoy/extensions/filters/http/rbac/v3:rbac",
        "@com_github_envoyproxy_go_control_plane//envoy/extensions/filters/http/router/v3:router",
        "@com_github_envoyproxy_go_control_plane//envoy/extensions/filters/network/http_connection_manager/v3:http_connection_manager",
        "@com_github_envoyproxy_go_control_plane//envoy/extensions/load_balancing_policies/least_request/v3:least_request",
        "@com_github_envoyproxy_go_control_plane//envoy/extensions/load_balancing_policies/ring_hash/v3:ring_hash",
        "@com_github_envoyproxy_go_control_plane//envoy/extensions/transport_sockets/tls/v3:tls",
        "@com_github_envoyproxy_go_control_plane//envoy/service/discovery/v3:discovery",
        "@com_github_envoyproxy_go_control_plane//envoy/type/matcher/v3:matcher",
        "@com_github_envoyproxy_go_control_plane//envoy/type/v3:type",
        "@com_github_golang_protobuf//proto:go_default_library",
        "@com_github_golang_protobuf//ptypes/any",
        "@com_github_golang_protobuf//ptypes/struct",
        "@com_github_golang_protobuf//ptypes/wrappers",
        "@com_github_google_go_cmp//cmp",
        "@com_github_google_go_cmp//cmp/cmpopts",
        "@org_golang_google_protobuf//testing/protocmp",
        "@org_golang_google_protobuf//types/known/anypb",
        "@org_golang_google_protobuf//types/known/durationpb",
        "@org_golang_google_protobuf//types/known/wrapperspb",
    ],
)
