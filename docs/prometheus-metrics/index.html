<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.14">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="BuildBuddy RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="BuildBuddy Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-156160991-1","auto"),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script><title data-react-helmet="true">Prometheus Metrics | BuildBuddy</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:image" content="https://www.buildbuddy.io/img/preview.png"><meta data-react-helmet="true" name="twitter:image" content="https://www.buildbuddy.io/img/preview.png"><meta data-react-helmet="true" property="og:url" content="https://www.buildbuddy.io/docs/prometheus-metrics"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" name="og:description" content="BuildBuddy provides enterprise features for Bazel â€” the open source build system that allows you to build and test software 10x faster."><meta data-react-helmet="true" property="og:title" content="Prometheus Metrics | BuildBuddy"><meta data-react-helmet="true" name="description" content="BuildBuddy exposes Prometheus metrics that allow monitoring the"><meta data-react-helmet="true" property="og:description" content="BuildBuddy exposes Prometheus metrics that allow monitoring the"><link data-react-helmet="true" rel="icon" href="/img/favicon_black.svg"><link data-react-helmet="true" rel="canonical" href="https://www.buildbuddy.io/docs/prometheus-metrics"><link data-react-helmet="true" rel="alternate" href="https://www.buildbuddy.io/docs/prometheus-metrics" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://www.buildbuddy.io/docs/prometheus-metrics" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.8fec09fa.css">
<link rel="preload" href="/assets/js/runtime~main.1a39789c.js" as="script">
<link rel="preload" href="/assets/js/main.d8c0b957.js" as="script">
</head>
<body data-theme="light">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" target="_self" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="BuildBuddy Logo" class="themedImage_1VuW themedImage--light_3UqQ" height="32px" width="191px"><img src="/img/logo_white.svg" alt="BuildBuddy Logo" class="themedImage_1VuW themedImage--dark_hz6m" height="32px" width="191px"></div></a><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link" href="/features">Features</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/ui">Build &amp; Test UI</a></li><li><a class="dropdown__link" href="/remote-execution">Remote Execution</a></li><li><a class="dropdown__link" href="/remote-cache">Remote Cache</a></li><li><a class="dropdown__link" href="/cli">BuildBuddy CLI</a></li></ul></div><a class="navbar__item navbar__link" target="_self" href="/pricing">Pricing</a><a href="https://github.com/buildbuddy-io/buildbuddy" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a class="navbar__item navbar__link" href="/blog/">Blog</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs/introduction/">Docs</a><a href="https://app.buildbuddy.io/" target="_self" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Login<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a href="https://app.buildbuddy.io/" target="_self" rel="noopener noreferrer" class="navbar__item navbar__link sign-up"><span>Get Started<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="dsla-search-wrapper"><div class="dsla-search-field" data-tags="default,docs-default-current"></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_35hR" type="button"></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/docs/introduction">Getting Started</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/introduction">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cloud">Cloud Quickstart</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/on-prem">On-prem Quickstart</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/contributing">Contributing</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/docs/guides">Guides</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guides">Guides</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide-auth">Authentication Guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide-metadata">Build Metadata Guide</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/docs/remote-build-execution">Remote Build Execution</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/remote-build-execution">Remote Build Execution</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rbe-setup">Remote Build Execution Setup</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rbe-platforms">RBE Platforms</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/secrets">RBE Secrets</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rbe-microvms">RBE with MicroVMs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rbe-github-actions">RBE with GitHub Actions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rbe-pools">RBE Executor Pools</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/docs/workflows-introduction">Workflows (CI)</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/workflows-introduction">Workflows introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/workflows-setup">Workflows setup</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/workflows-config">Workflows configuration</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/docs/cli">CLI</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cli">CLI Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cli-plugins">CLI Plugins</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/docs/troubleshooting">Troubleshooting</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/troubleshooting">Troubleshooting</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/troubleshooting-rbe">RBE Failures</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/troubleshooting-slow-upload">Slow Uploads</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/docs/enterprise">Enterprise</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/enterprise">BuildBuddy Enterprise</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/enterprise-setup">Enterprise On-prem Setup</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/enterprise-config">Enterprise Configuration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/enterprise-helm">Enterprise Helm Charts</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/enterprise-rbe">Enterprise RBE Setup</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/enterprise-mac-rbe">Enterprise Mac RBE Setup</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/enterprise-api">Enterprise API</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_2fq0" href="/docs/prometheus-metrics">Monitoring</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/prometheus-metrics">Prometheus Metrics</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/docs/architecture-overview">Architecture</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/architecture-overview">Architecture Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/architecture-data-storage">Data Storage Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/architecture-build-event-write">Life of a Build EventÂ Write</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/architecture-build-event-read">Life of a Build EventÂ Read</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/architecture-cache-write">Life of a Cache Write</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/architecture-cache-read">Life of a Cache Read</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/architecture-remote-execution">Life of a Remote Execution</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/architecture-self-hosted-executor">Life of a Self Hosted Executor</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/docs/config">Configuration</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config-samples">Samples</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config-app">App</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config-database">Database</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config-storage">Storage</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config-cache">Cache</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config-github">GitHub</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config-ssl">SSL</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config-auth">Auth</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config-integrations">Integrations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config-org">Org</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config-rbe">RBE</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config-misc">Misc</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config-api">API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config-telemetry">Telemetry</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config-flags">Flags</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config-all-options">All Options</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="theme-doc-markdown markdown"><header><h1>Prometheus Metrics</h1></header><p>BuildBuddy exposes <a href="https://prometheus.io" target="_blank" rel="noopener noreferrer">Prometheus</a> metrics that allow monitoring the
<a href="https://landing.google.com/sre/sre-book/chapters/monitoring-distributed-systems/" target="_blank" rel="noopener noreferrer">four golden signals</a>:
latency, traffic, errors, and saturation.</p><p>Prometheus metrics are exposed under the path <code>metrics/</code> on port <code>9090</code> by default.</p><p>To view these metrics in a live-updating dashboard, we recommend using a tool
like <a href="https://grafana.com" target="_blank" rel="noopener noreferrer">Grafana</a>.</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="invocation-build-event-metrics">Invocation build event metrics<a class="hash-link" href="#invocation-build-event-metrics" title="Direct link to heading">â€‹</a></h2><p>All invocation metrics are recorded at the <em>end</em> of each invocation.</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_invocation_count-counter"><strong><code>buildbuddy_invocation_count</code></strong> (Counter)<a class="hash-link" href="#buildbuddy_invocation_count-counter" title="Direct link to heading">â€‹</a></h3><p>The total number of invocations whose logs were uploaded to BuildBuddy.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="labels">Labels<a class="hash-link" href="#labels" title="Direct link to heading">â€‹</a></h4><ul><li><strong>invocation_status</strong>: Invocation status: <code>success</code>, <code>failure</code>, <code>disconnected</code>, or <code>unknown</code>.</li><li><strong>bazel_exit_code</strong>: Exit code of a completed bazel command</li><li><strong>bazel_command</strong>: Command provided to the Bazel daemon: <code>run</code>, <code>test</code>, <code>build</code>, <code>coverage</code>, <code>mobile-install</code>, ...</li></ul><h4 class="anchor anchorWithStickyNavbar_31ik" id="examples">Examples<a class="hash-link" href="#examples" title="Direct link to heading">â€‹</a></h4><div class="codeBlockContainer_K1bP language-promql theme-code-block"><div class="codeBlockContent_hGly promql"><pre tabindex="0" class="prism-code language-promql codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Number of invocations per second by invocation status</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">sum by (invocation_status) (rate(buildbuddy_invocation_count[5m]))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Invocation success rate</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">sum(rate(buildbuddy_invocation_count{invocation_status=&quot;success&quot;}[5m]))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  /</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">sum(rate(buildbuddy_invocation_count[5m]))</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_invocation_duration_usec-histogram"><strong><code>buildbuddy_invocation_duration_usec</code></strong> (Histogram)<a class="hash-link" href="#buildbuddy_invocation_duration_usec-histogram" title="Direct link to heading">â€‹</a></h3><p>The total duration of each invocation, in <strong>microseconds</strong>.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="labels-1">Labels<a class="hash-link" href="#labels-1" title="Direct link to heading">â€‹</a></h4><ul><li><strong>invocation_status</strong>: Invocation status: <code>success</code>, <code>failure</code>, <code>disconnected</code>, or <code>unknown</code>.</li><li><strong>bazel_command</strong>: Command provided to the Bazel daemon: <code>run</code>, <code>test</code>, <code>build</code>, <code>coverage</code>, <code>mobile-install</code>, ...</li></ul><h4 class="anchor anchorWithStickyNavbar_31ik" id="examples-1">Examples<a class="hash-link" href="#examples-1" title="Direct link to heading">â€‹</a></h4><div class="codeBlockContainer_K1bP language-promql theme-code-block"><div class="codeBlockContent_hGly promql"><pre tabindex="0" class="prism-code language-promql codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Median invocation duration in the past 5 minutes</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">histogram_quantile(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  0.5,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  sum(rate(buildbuddy_invocation_duration_usec_bucket[5m])) by (le)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_invocation_build_event_count-counter"><strong><code>buildbuddy_invocation_build_event_count</code></strong> (Counter)<a class="hash-link" href="#buildbuddy_invocation_build_event_count-counter" title="Direct link to heading">â€‹</a></h3><p>Number of <a href="https://docs.bazel.build/versions/master/build-event-protocol.html" target="_blank" rel="noopener noreferrer">build events</a> uploaded to BuildBuddy.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="labels-2">Labels<a class="hash-link" href="#labels-2" title="Direct link to heading">â€‹</a></h4><ul><li><strong>status</strong>: Status code as defined by <a href="https://godoc.org/google.golang.org/grpc/codes#Code" target="_blank" rel="noopener noreferrer">grpc/codes</a>. This is a numeric value; any non-zero code indicates an error.</li></ul><h4 class="anchor anchorWithStickyNavbar_31ik" id="examples-2">Examples<a class="hash-link" href="#examples-2" title="Direct link to heading">â€‹</a></h4><div class="codeBlockContainer_K1bP language-promql theme-code-block"><div class="codeBlockContent_hGly promql"><pre tabindex="0" class="prism-code language-promql codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Build events uploaded per second</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">sum(rate(buildbuddy_invocation_build_event_count[5m]))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Approximate error rate of build event upload handler</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">sum(rate(buildbuddy_invocation_build_event_count{status=&quot;0&quot;}[5m]))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  /</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">sum(rate(buildbuddy_invocation_build_event_count[5m]))</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_invocation_stats_recorder_workers-gauge"><strong><code>buildbuddy_invocation_stats_recorder_workers</code></strong> (Gauge)<a class="hash-link" href="#buildbuddy_invocation_stats_recorder_workers-gauge" title="Direct link to heading">â€‹</a></h3><p>Number of invocation stats recorder workers currently running.</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_invocation_stats_recorder_duration_usec-histogram"><strong><code>buildbuddy_invocation_stats_recorder_duration_usec</code></strong> (Histogram)<a class="hash-link" href="#buildbuddy_invocation_stats_recorder_duration_usec-histogram" title="Direct link to heading">â€‹</a></h3><p>How long it took to finalize an invocation&#x27;s stats, in <strong>microseconds</strong>.</p><p>This includes the time required to wait for all BuildBuddy apps to flush their local metrics to Redis (if applicable) and then record the metrics to the DB.</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_invocation_webhook_invocation_lookup_workers-gauge"><strong><code>buildbuddy_invocation_webhook_invocation_lookup_workers</code></strong> (Gauge)<a class="hash-link" href="#buildbuddy_invocation_webhook_invocation_lookup_workers-gauge" title="Direct link to heading">â€‹</a></h3><p>Number of webhook invocation lookup workers currently running.</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_invocation_webhook_invocation_lookup_duration_usec-histogram"><strong><code>buildbuddy_invocation_webhook_invocation_lookup_duration_usec</code></strong> (Histogram)<a class="hash-link" href="#buildbuddy_invocation_webhook_invocation_lookup_duration_usec-histogram" title="Direct link to heading">â€‹</a></h3><p>How long it took to lookup an invocation before posting to the webhook, in <strong>microseconds</strong>.</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_invocation_webhook_notify_workers-gauge"><strong><code>buildbuddy_invocation_webhook_notify_workers</code></strong> (Gauge)<a class="hash-link" href="#buildbuddy_invocation_webhook_notify_workers-gauge" title="Direct link to heading">â€‹</a></h3><p>Number of webhook notify workers currently running.</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_invocation_webhook_notify_duration_usec-histogram"><strong><code>buildbuddy_invocation_webhook_notify_duration_usec</code></strong> (Histogram)<a class="hash-link" href="#buildbuddy_invocation_webhook_notify_duration_usec-histogram" title="Direct link to heading">â€‹</a></h3><p>How long it took to post an invocation proto to the webhook, in <strong>microseconds</strong>.</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="remote-cache-metrics">Remote cache metrics<a class="hash-link" href="#remote-cache-metrics" title="Direct link to heading">â€‹</a></h2><p>NOTE: Cache metrics are recorded at the end of each invocation,
which means that these metrics provide <em>approximate</em> real-time signals.</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_remote_cache_events-counter"><strong><code>buildbuddy_remote_cache_events</code></strong> (Counter)<a class="hash-link" href="#buildbuddy_remote_cache_events-counter" title="Direct link to heading">â€‹</a></h3><p>Number of cache events handled.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="labels-3">Labels<a class="hash-link" href="#labels-3" title="Direct link to heading">â€‹</a></h4><ul><li><strong>cache_type</strong>: Cache type: <code>action</code> for action cache, <code>cas</code> for content-addressable storage.</li><li><strong>cache_event_type</strong>: Cache event type: <code>hit</code>, <code>miss</code>, or <code>upload</code>.</li></ul><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_remote_cache_download_size_bytes-histogram"><strong><code>buildbuddy_remote_cache_download_size_bytes</code></strong> (Histogram)<a class="hash-link" href="#buildbuddy_remote_cache_download_size_bytes-histogram" title="Direct link to heading">â€‹</a></h3><p>Number of bytes downloaded from the remote cache in each download.</p><p>Use the <strong><code>_sum</code></strong> suffix to get the total downloaded bytes and the <strong><code>_count</code></strong> suffix to get the number of downloaded files.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="labels-4">Labels<a class="hash-link" href="#labels-4" title="Direct link to heading">â€‹</a></h4><ul><li><strong>cache_type</strong>: Cache type: <code>action</code> for action cache, <code>cas</code> for content-addressable storage.</li></ul><h4 class="anchor anchorWithStickyNavbar_31ik" id="examples-3">Examples<a class="hash-link" href="#examples-3" title="Direct link to heading">â€‹</a></h4><div class="codeBlockContainer_K1bP language-promql theme-code-block"><div class="codeBlockContent_hGly promql"><pre tabindex="0" class="prism-code language-promql codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Cache download rate (bytes per second)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">sum(rate(buildbuddy_cache_download_size_bytes_sum[5m]))</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_remote_cache_download_duration_usec-histogram"><strong><code>buildbuddy_remote_cache_download_duration_usec</code></strong> (Histogram)<a class="hash-link" href="#buildbuddy_remote_cache_download_duration_usec-histogram" title="Direct link to heading">â€‹</a></h3><p>Download duration for each file downloaded from the remote cache, in <strong>microseconds</strong>.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="labels-5">Labels<a class="hash-link" href="#labels-5" title="Direct link to heading">â€‹</a></h4><ul><li><strong>cache_type</strong>: Cache type: <code>action</code> for action cache, <code>cas</code> for content-addressable storage.</li></ul><h4 class="anchor anchorWithStickyNavbar_31ik" id="examples-4">Examples<a class="hash-link" href="#examples-4" title="Direct link to heading">â€‹</a></h4><div class="codeBlockContainer_K1bP language-promql theme-code-block"><div class="codeBlockContent_hGly promql"><pre tabindex="0" class="prism-code language-promql codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Median download duration for content-addressable store (CAS)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">histogram_quantile(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  0.5,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  sum(rate(buildbuddy_remote_cache_download_duration_usec{cache_type=&quot;cas&quot;}[5m])) by (le)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_remote_cache_upload_size_bytes-histogram"><strong><code>buildbuddy_remote_cache_upload_size_bytes</code></strong> (Histogram)<a class="hash-link" href="#buildbuddy_remote_cache_upload_size_bytes-histogram" title="Direct link to heading">â€‹</a></h3><p>Number of bytes uploaded to the remote cache in each upload.</p><p>Use the <strong><code>_sum</code></strong> suffix to get the total uploaded bytes and the <strong><code>_count</code></strong> suffix to get the number of uploaded files.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="labels-6">Labels<a class="hash-link" href="#labels-6" title="Direct link to heading">â€‹</a></h4><ul><li><strong>cache_type</strong>: Cache type: <code>action</code> for action cache, <code>cas</code> for content-addressable storage.</li></ul><h4 class="anchor anchorWithStickyNavbar_31ik" id="examples-5">Examples<a class="hash-link" href="#examples-5" title="Direct link to heading">â€‹</a></h4><div class="codeBlockContainer_K1bP language-promql theme-code-block"><div class="codeBlockContent_hGly promql"><pre tabindex="0" class="prism-code language-promql codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Cache upload rate (bytes per second)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">sum(rate(buildbuddy_cache_upload_size_bytes_sum[5m]))</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_remote_cache_upload_duration_usec-histogram"><strong><code>buildbuddy_remote_cache_upload_duration_usec</code></strong> (Histogram)<a class="hash-link" href="#buildbuddy_remote_cache_upload_duration_usec-histogram" title="Direct link to heading">â€‹</a></h3><p>Upload duration for each file uploaded to the remote cache, in <strong>microseconds</strong>.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="labels-7">Labels<a class="hash-link" href="#labels-7" title="Direct link to heading">â€‹</a></h4><ul><li><strong>cache_type</strong>: Cache type: <code>action</code> for action cache, <code>cas</code> for content-addressable storage.</li></ul><h4 class="anchor anchorWithStickyNavbar_31ik" id="examples-6">Examples<a class="hash-link" href="#examples-6" title="Direct link to heading">â€‹</a></h4><div class="codeBlockContainer_K1bP language-promql theme-code-block"><div class="codeBlockContent_hGly promql"><pre tabindex="0" class="prism-code language-promql codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Median upload duration for content-addressable store (CAS)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">histogram_quantile(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  0.5,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  sum(rate(buildbuddy_remote_cache_upload_duration_usec{cache_type=&quot;cas&quot;}[5m])) by (le)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_remote_cache_disk_cache_last_eviction_age_usec-gauge"><strong><code>buildbuddy_remote_cache_disk_cache_last_eviction_age_usec</code></strong> (Gauge)<a class="hash-link" href="#buildbuddy_remote_cache_disk_cache_last_eviction_age_usec-gauge" title="Direct link to heading">â€‹</a></h3><p>The age of the item most recently evicted from the cache, in <strong>microseconds</strong>.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="labels-8">Labels<a class="hash-link" href="#labels-8" title="Direct link to heading">â€‹</a></h4><ul><li><strong>partition_id</strong>: The ID of the disk cache partition this event applied to.</li></ul><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_remote_cache_disk_cache_duplicate_writes-counter"><strong><code>buildbuddy_remote_cache_disk_cache_duplicate_writes</code></strong> (Counter)<a class="hash-link" href="#buildbuddy_remote_cache_disk_cache_duplicate_writes-counter" title="Direct link to heading">â€‹</a></h3><p>Number of writes for digests that already exist.</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_remote_cache_disk_cache_usec_since_last_access-histogram"><strong><code>buildbuddy_remote_cache_disk_cache_usec_since_last_access</code></strong> (Histogram)<a class="hash-link" href="#buildbuddy_remote_cache_disk_cache_usec_since_last_access-histogram" title="Direct link to heading">â€‹</a></h3><p>Time since last digest access, in <strong>microseconds</strong>.</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_remote_cache_disk_cache_added_file_size_bytes-histogram"><strong><code>buildbuddy_remote_cache_disk_cache_added_file_size_bytes</code></strong> (Histogram)<a class="hash-link" href="#buildbuddy_remote_cache_disk_cache_added_file_size_bytes-histogram" title="Direct link to heading">â€‹</a></h3><p>Size of artifacts added to the file cache, in <strong>bytes</strong>.</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_remote_cache_disk_cache_filesystem_total_bytes-gauge"><strong><code>buildbuddy_remote_cache_disk_cache_filesystem_total_bytes</code></strong> (Gauge)<a class="hash-link" href="#buildbuddy_remote_cache_disk_cache_filesystem_total_bytes-gauge" title="Direct link to heading">â€‹</a></h3><p>Total size of the underlying filesystem.</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_remote_cache_disk_cache_filesystem_avail_bytes-gauge"><strong><code>buildbuddy_remote_cache_disk_cache_filesystem_avail_bytes</code></strong> (Gauge)<a class="hash-link" href="#buildbuddy_remote_cache_disk_cache_filesystem_avail_bytes-gauge" title="Direct link to heading">â€‹</a></h3><p>Available bytes in the underlying filesystem.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="examples-7">Examples<a class="hash-link" href="#examples-7" title="Direct link to heading">â€‹</a></h4><div class="codeBlockContainer_K1bP language-promql theme-code-block"><div class="codeBlockContent_hGly promql"><pre tabindex="0" class="prism-code language-promql codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Total number of duplicate writes.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">sum(buildbuddy_remote_cache_duplicate_writes)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_remote_cache_disk_cache_duplicate_writes_bytes-counter"><strong><code>buildbuddy_remote_cache_disk_cache_duplicate_writes_bytes</code></strong> (Counter)<a class="hash-link" href="#buildbuddy_remote_cache_disk_cache_duplicate_writes_bytes-counter" title="Direct link to heading">â€‹</a></h3><p>Number of bytes written that already existed in the cache.</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_remote_cache_migration_not_found_error_count-counter"><strong><code>buildbuddy_remote_cache_migration_not_found_error_count</code></strong> (Counter)<a class="hash-link" href="#buildbuddy_remote_cache_migration_not_found_error_count-counter" title="Direct link to heading">â€‹</a></h3><p>Number of not found errors from the destination cache during a cache migration.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="labels-9">Labels<a class="hash-link" href="#labels-9" title="Direct link to heading">â€‹</a></h4><ul><li><strong>type</strong>: </li></ul><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_remote_cache_migration_copy_chan_size-gauge"><strong><code>buildbuddy_remote_cache_migration_copy_chan_size</code></strong> (Gauge)<a class="hash-link" href="#buildbuddy_remote_cache_migration_copy_chan_size-gauge" title="Direct link to heading">â€‹</a></h3><p>Number of digests queued to be copied during a cache migration.</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="remote-execution-metrics">Remote execution metrics<a class="hash-link" href="#remote-execution-metrics" title="Direct link to heading">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_remote_execution_count-counter"><strong><code>buildbuddy_remote_execution_count</code></strong> (Counter)<a class="hash-link" href="#buildbuddy_remote_execution_count-counter" title="Direct link to heading">â€‹</a></h3><p>Number of actions executed remotely.</p><p>This only includes actions which reached the execution phase. If an action fails before execution (for example, if it fails authentication) then this metric is not incremented.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="labels-10">Labels<a class="hash-link" href="#labels-10" title="Direct link to heading">â€‹</a></h4><ul><li><strong>exit_code</strong>: Process exit code of an executed action.</li><li><strong>status</strong>: Status code as defined by <a href="https://godoc.org/google.golang.org/grpc/codes#Code" target="_blank" rel="noopener noreferrer">grpc/codes</a> in human-readable format, such as &quot;OK&quot; or &quot;NotFound&quot;.</li><li><strong>isolation</strong>: Effective workload isolation type used for an executed task, such as &quot;docker&quot;, &quot;podman&quot;, &quot;firecracker&quot;, or &quot;none&quot;.</li></ul><h4 class="anchor anchorWithStickyNavbar_31ik" id="examples-8">Examples<a class="hash-link" href="#examples-8" title="Direct link to heading">â€‹</a></h4><div class="codeBlockContainer_K1bP language-promql theme-code-block"><div class="codeBlockContent_hGly promql"><pre tabindex="0" class="prism-code language-promql codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Total number of actions executed per second</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">sum(rate(buildbuddy_remote_execution_count[5m]))</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_remote_execution_tasks_started_count-counter"><strong><code>buildbuddy_remote_execution_tasks_started_count</code></strong> (Counter)<a class="hash-link" href="#buildbuddy_remote_execution_tasks_started_count-counter" title="Direct link to heading">â€‹</a></h3><p>Number of tasks started remotely, but not necessarily completed.</p><p>Includes retry attempts of the same task.</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_remote_execution_executed_action_metadata_durations_usec-histogram"><strong><code>buildbuddy_remote_execution_executed_action_metadata_durations_usec</code></strong> (Histogram)<a class="hash-link" href="#buildbuddy_remote_execution_executed_action_metadata_durations_usec-histogram" title="Direct link to heading">â€‹</a></h3><p>Time spent in each stage of action execution, in <strong>microseconds</strong>.</p><p>Queries should filter or group by the <code>stage</code> label, taking care not to aggregate different stages.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="labels-11">Labels<a class="hash-link" href="#labels-11" title="Direct link to heading">â€‹</a></h4><ul><li><strong>stage</strong>: Executed action stage. Action execution is split into stages corresponding to the timestamps defined in <a href="https://github.com/buildbuddy-io/buildbuddy/blob/fb2e3a74083d82797926654409dc3858089d260b/proto/remote_execution.proto#L797" target="_blank" rel="noopener noreferrer"><code>ExecutedActionMetadata</code></a>: <code>queued</code>, <code>input_fetch</code>, <code>execution</code>, and <code>output_upload</code>. An additional stage, <code>worker</code>, includes all stages during which a worker is handling the action, which is all stages except the <code>queued</code> stage.</li><li><strong>group_id</strong>: Group (organization) ID associated with the request.</li></ul><h4 class="anchor anchorWithStickyNavbar_31ik" id="examples-9">Examples<a class="hash-link" href="#examples-9" title="Direct link to heading">â€‹</a></h4><div class="codeBlockContainer_K1bP language-promql theme-code-block"><div class="codeBlockContent_hGly promql"><pre tabindex="0" class="prism-code language-promql codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Median duration of all command stages</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">histogram_quantile(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  0.5,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  sum(rate(buildbuddy_remote_execution_executed_action_metadata_durations_usec_bucket[5m])) by (le, stage)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># p90 duration of just the command execution stage</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">histogram_quantile(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  0.9,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  sum(rate(buildbuddy_remote_execution_executed_action_metadata_durations_usec_bucket{stage=&quot;execution&quot;}[5m])) by (le)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_remote_execution_task_size_read_requests-counter"><strong><code>buildbuddy_remote_execution_task_size_read_requests</code></strong> (Counter)<a class="hash-link" href="#buildbuddy_remote_execution_task_size_read_requests-counter" title="Direct link to heading">â€‹</a></h3><p>Number of read requests to the task sizer, which estimates action resource usage based on historical execution stats.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="labels-12">Labels<a class="hash-link" href="#labels-12" title="Direct link to heading">â€‹</a></h4><ul><li><strong>status</strong>: Status of the task size read request: <code>hit</code>, <code>miss</code>, or <code>error</code>.</li><li><strong>isolation</strong>: Effective workload isolation type used for an executed task, such as &quot;docker&quot;, &quot;podman&quot;, &quot;firecracker&quot;, or &quot;none&quot;.</li><li><strong>os</strong>: OS associated with the request.</li><li><strong>arch</strong>: CPU architecture associated with the request.</li><li><strong>group_id</strong>: Group (organization) ID associated with the request.</li></ul><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_remote_execution_task_size_write_requests-counter"><strong><code>buildbuddy_remote_execution_task_size_write_requests</code></strong> (Counter)<a class="hash-link" href="#buildbuddy_remote_execution_task_size_write_requests-counter" title="Direct link to heading">â€‹</a></h3><p>Number of write requests to the task sizer, which estimates action resource usage based on historical execution stats.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="labels-13">Labels<a class="hash-link" href="#labels-13" title="Direct link to heading">â€‹</a></h4><ul><li><strong>status</strong>: Status of the task size write request: <code>ok</code>, <code>missing_stats</code> or <code>error</code>.</li><li><strong>isolation</strong>: Effective workload isolation type used for an executed task, such as &quot;docker&quot;, &quot;podman&quot;, &quot;firecracker&quot;, or &quot;none&quot;.</li><li><strong>os</strong>: OS associated with the request.</li><li><strong>arch</strong>: CPU architecture associated with the request.</li><li><strong>group_id</strong>: Group (organization) ID associated with the request.</li></ul><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_remote_execution_task_size_prediction_duration_usec-histogram"><strong><code>buildbuddy_remote_execution_task_size_prediction_duration_usec</code></strong> (Histogram)<a class="hash-link" href="#buildbuddy_remote_execution_task_size_prediction_duration_usec-histogram" title="Direct link to heading">â€‹</a></h3><p>Task size prediction model request duration in <strong>microseconds</strong>.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="labels-14">Labels<a class="hash-link" href="#labels-14" title="Direct link to heading">â€‹</a></h4><ul><li><strong>status</strong>: Status code as defined by <a href="https://godoc.org/google.golang.org/grpc/codes#Code" target="_blank" rel="noopener noreferrer">grpc/codes</a> in human-readable format, such as &quot;OK&quot; or &quot;NotFound&quot;.</li></ul><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_remote_execution_waiting_execution_result-gauge"><strong><code>buildbuddy_remote_execution_waiting_execution_result</code></strong> (Gauge)<a class="hash-link" href="#buildbuddy_remote_execution_waiting_execution_result-gauge" title="Direct link to heading">â€‹</a></h3><p>Number of execution requests for which the client is actively waiting for results.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="labels-15">Labels<a class="hash-link" href="#labels-15" title="Direct link to heading">â€‹</a></h4><ul><li><strong>group_id</strong>: Group (organization) ID associated with the request.</li></ul><h4 class="anchor anchorWithStickyNavbar_31ik" id="examples-10">Examples<a class="hash-link" href="#examples-10" title="Direct link to heading">â€‹</a></h4><div class="codeBlockContainer_K1bP language-promql theme-code-block"><div class="codeBlockContent_hGly promql"><pre tabindex="0" class="prism-code language-promql codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Total number of execution requests with client waiting for result.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">sum(buildbuddy_remote_execution_waiting_execution_result)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_remote_execution_requests-counter"><strong><code>buildbuddy_remote_execution_requests</code></strong> (Counter)<a class="hash-link" href="#buildbuddy_remote_execution_requests-counter" title="Direct link to heading">â€‹</a></h3><p>Number of execution requests received.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="labels-16">Labels<a class="hash-link" href="#labels-16" title="Direct link to heading">â€‹</a></h4><ul><li><strong>group_id</strong>: Group (organization) ID associated with the request.</li><li><strong>os</strong>: OS associated with the request.</li><li><strong>arch</strong>: CPU architecture associated with the request.</li></ul><h4 class="anchor anchorWithStickyNavbar_31ik" id="examples-11">Examples<a class="hash-link" href="#examples-11" title="Direct link to heading">â€‹</a></h4><div class="codeBlockContainer_K1bP language-promql theme-code-block"><div class="codeBlockContent_hGly promql"><pre tabindex="0" class="prism-code language-promql codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Rate of new execution requests by OS/Arch.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">sum(rate(buildbuddy_remote_execution_requests[1m])) by (os, arch)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_remote_execution_merged_actions-counter"><strong><code>buildbuddy_remote_execution_merged_actions</code></strong> (Counter)<a class="hash-link" href="#buildbuddy_remote_execution_merged_actions-counter" title="Direct link to heading">â€‹</a></h3><p>Number of identical execution requests that have been merged.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="labels-17">Labels<a class="hash-link" href="#labels-17" title="Direct link to heading">â€‹</a></h4><ul><li><strong>group_id</strong>: Group (organization) ID associated with the request.</li></ul><h4 class="anchor anchorWithStickyNavbar_31ik" id="examples-12">Examples<a class="hash-link" href="#examples-12" title="Direct link to heading">â€‹</a></h4><div class="codeBlockContainer_K1bP language-promql theme-code-block"><div class="codeBlockContent_hGly promql"><pre tabindex="0" class="prism-code language-promql codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Rate of merged actions by group.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">sum(rate(buildbuddy_remote_execution_merged_actions[1m])) by (group_id)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_remote_execution_queue_length-gauge"><strong><code>buildbuddy_remote_execution_queue_length</code></strong> (Gauge)<a class="hash-link" href="#buildbuddy_remote_execution_queue_length-gauge" title="Direct link to heading">â€‹</a></h3><p>Number of actions currently waiting in the executor queue.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="labels-18">Labels<a class="hash-link" href="#labels-18" title="Direct link to heading">â€‹</a></h4><ul><li><strong>group_id</strong>: Group (organization) ID associated with the request.</li></ul><h4 class="anchor anchorWithStickyNavbar_31ik" id="examples-13">Examples<a class="hash-link" href="#examples-13" title="Direct link to heading">â€‹</a></h4><div class="codeBlockContainer_K1bP language-promql theme-code-block"><div class="codeBlockContent_hGly promql"><pre tabindex="0" class="prism-code language-promql codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Median queue length across all executors</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">quantile(0.5, buildbuddy_remote_execution_queue_length)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_remote_execution_tasks_executing-gauge"><strong><code>buildbuddy_remote_execution_tasks_executing</code></strong> (Gauge)<a class="hash-link" href="#buildbuddy_remote_execution_tasks_executing-gauge" title="Direct link to heading">â€‹</a></h3><p>Number of tasks currently being executed by the executor.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="labels-19">Labels<a class="hash-link" href="#labels-19" title="Direct link to heading">â€‹</a></h4><ul><li><strong>stage</strong>: Executed action stage. Action execution is split into stages corresponding to the timestamps defined in <a href="https://github.com/buildbuddy-io/buildbuddy/blob/fb2e3a74083d82797926654409dc3858089d260b/proto/remote_execution.proto#L797" target="_blank" rel="noopener noreferrer"><code>ExecutedActionMetadata</code></a>: <code>queued</code>, <code>input_fetch</code>, <code>execution</code>, and <code>output_upload</code>. An additional stage, <code>worker</code>, includes all stages during which a worker is handling the action, which is all stages except the <code>queued</code> stage.</li></ul><h4 class="anchor anchorWithStickyNavbar_31ik" id="examples-14">Examples<a class="hash-link" href="#examples-14" title="Direct link to heading">â€‹</a></h4><div class="codeBlockContainer_K1bP language-promql theme-code-block"><div class="codeBlockContent_hGly promql"><pre tabindex="0" class="prism-code language-promql codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Fraction of idle executors</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">count_values(0, buildbuddy_remote_execution_tasks_executing)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  /</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">count(buildbuddy_remote_execution_tasks_executing)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_remote_execution_assigned_ram_bytes-gauge"><strong><code>buildbuddy_remote_execution_assigned_ram_bytes</code></strong> (Gauge)<a class="hash-link" href="#buildbuddy_remote_execution_assigned_ram_bytes-gauge" title="Direct link to heading">â€‹</a></h3><p>Estimated RAM on the executor that is currently allocated for task execution, in <strong>bytes</strong>.</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_remote_execution_assignable_ram_bytes-gauge"><strong><code>buildbuddy_remote_execution_assignable_ram_bytes</code></strong> (Gauge)<a class="hash-link" href="#buildbuddy_remote_execution_assignable_ram_bytes-gauge" title="Direct link to heading">â€‹</a></h3><p>Maximum total RAM that can be allocated for task execution, in <strong>bytes</strong>.</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_remote_execution_assigned_milli_cpu-gauge"><strong><code>buildbuddy_remote_execution_assigned_milli_cpu</code></strong> (Gauge)<a class="hash-link" href="#buildbuddy_remote_execution_assigned_milli_cpu-gauge" title="Direct link to heading">â€‹</a></h3><p>Estimated CPU time on the executor that is currently allocated for task execution, in <strong>milliCPU</strong> (CPU-milliseconds per second).</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_remote_execution_assignable_milli_cpu-gauge"><strong><code>buildbuddy_remote_execution_assignable_milli_cpu</code></strong> (Gauge)<a class="hash-link" href="#buildbuddy_remote_execution_assignable_milli_cpu-gauge" title="Direct link to heading">â€‹</a></h3><p>Maximum total CPU time on the executor that can be allocated for task execution, in <strong>milliCPU</strong> (CPU-milliseconds per second).</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_remote_execution_memory_usage_bytes-gauge"><strong><code>buildbuddy_remote_execution_memory_usage_bytes</code></strong> (Gauge)<a class="hash-link" href="#buildbuddy_remote_execution_memory_usage_bytes-gauge" title="Direct link to heading">â€‹</a></h3><p>Current total task memory usage in <strong>bytes</strong>.</p><p>This only accounts for tasks which are actively executing. To see memory usage of pooled runners, sum with runner pool memory usage.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="examples-15">Examples<a class="hash-link" href="#examples-15" title="Direct link to heading">â€‹</a></h4><div class="codeBlockContainer_K1bP language-promql theme-code-block"><div class="codeBlockContent_hGly promql"><pre tabindex="0" class="prism-code language-promql codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Total approximate memory usage of active and pooled runners,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># grouped by executor pod.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">sum by (pod_name) (</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  buildbuddy_remote_execution_memory_usage_bytes</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  + buildbuddy_remote_execution_runner_pool_memory_usage_bytes</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_remote_execution_peak_memory_usage_bytes-gauge"><strong><code>buildbuddy_remote_execution_peak_memory_usage_bytes</code></strong> (Gauge)<a class="hash-link" href="#buildbuddy_remote_execution_peak_memory_usage_bytes-gauge" title="Direct link to heading">â€‹</a></h3><p>Current total peak memory usage in <strong>bytes</strong>.</p><p>This is the sum of the peak memory usage for all tasks currently executing. It is not a very useful metric on its own, and is mainly intended for comparison with <code>assigned_ram_bytes</code>.</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_remote_execution_used_milli_cpu-counter"><strong><code>buildbuddy_remote_execution_used_milli_cpu</code></strong> (Counter)<a class="hash-link" href="#buildbuddy_remote_execution_used_milli_cpu-counter" title="Direct link to heading">â€‹</a></h3><p>Approximate cumulative CPU usage of executed tasks, in <strong>CPU-milliseconds</strong>.</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_remote_execution_cpu_utilization_milli_cpu-gauge"><strong><code>buildbuddy_remote_execution_cpu_utilization_milli_cpu</code></strong> (Gauge)<a class="hash-link" href="#buildbuddy_remote_execution_cpu_utilization_milli_cpu-gauge" title="Direct link to heading">â€‹</a></h3><p>Approximate current CPU utilization of tasks executing, in <strong>milli-CPU</strong> (CPU-milliseconds per second).</p><p>This allows for much higher granularity than using a <code>rate()</code> on <code>used_milli_cpu</code> metric.</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_remote_execution_file_download_count-histogram"><strong><code>buildbuddy_remote_execution_file_download_count</code></strong> (Histogram)<a class="hash-link" href="#buildbuddy_remote_execution_file_download_count-histogram" title="Direct link to heading">â€‹</a></h3><p>Number of files downloaded during remote execution.</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_remote_execution_file_download_size_bytes-histogram"><strong><code>buildbuddy_remote_execution_file_download_size_bytes</code></strong> (Histogram)<a class="hash-link" href="#buildbuddy_remote_execution_file_download_size_bytes-histogram" title="Direct link to heading">â€‹</a></h3><p>Total number of bytes downloaded during remote execution.</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_remote_execution_file_download_duration_usec-histogram"><strong><code>buildbuddy_remote_execution_file_download_duration_usec</code></strong> (Histogram)<a class="hash-link" href="#buildbuddy_remote_execution_file_download_duration_usec-histogram" title="Direct link to heading">â€‹</a></h3><p>Per-file download duration during remote execution, in <strong>microseconds</strong>.</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_remote_execution_file_upload_count-histogram"><strong><code>buildbuddy_remote_execution_file_upload_count</code></strong> (Histogram)<a class="hash-link" href="#buildbuddy_remote_execution_file_upload_count-histogram" title="Direct link to heading">â€‹</a></h3><p>Number of files uploaded during remote execution.</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_remote_execution_file_upload_size_bytes-histogram"><strong><code>buildbuddy_remote_execution_file_upload_size_bytes</code></strong> (Histogram)<a class="hash-link" href="#buildbuddy_remote_execution_file_upload_size_bytes-histogram" title="Direct link to heading">â€‹</a></h3><p>Total number of bytes uploaded during remote execution.</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_remote_execution_file_upload_duration_usec-histogram"><strong><code>buildbuddy_remote_execution_file_upload_duration_usec</code></strong> (Histogram)<a class="hash-link" href="#buildbuddy_remote_execution_file_upload_duration_usec-histogram" title="Direct link to heading">â€‹</a></h3><p>Per-file upload duration during remote execution, in <strong>microseconds</strong>.</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_remote_execution_recycle_runner_requests-counter"><strong><code>buildbuddy_remote_execution_recycle_runner_requests</code></strong> (Counter)<a class="hash-link" href="#buildbuddy_remote_execution_recycle_runner_requests-counter" title="Direct link to heading">â€‹</a></h3><p>Number of execution requests with runner recycling enabled (via the platform property <code>recycle-runner=true</code>).</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="labels-20">Labels<a class="hash-link" href="#labels-20" title="Direct link to heading">â€‹</a></h4><ul><li><strong>status</strong>: Status of the recycle runner request: <code>hit</code> if the executor assigned a recycled runner to the action; <code>miss</code> otherwise.</li></ul><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_remote_execution_runner_pool_count-gauge"><strong><code>buildbuddy_remote_execution_runner_pool_count</code></strong> (Gauge)<a class="hash-link" href="#buildbuddy_remote_execution_runner_pool_count-gauge" title="Direct link to heading">â€‹</a></h3><p>Number of command runners that are currently pooled (and available for recycling).</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_remote_execution_runner_pool_evictions-counter"><strong><code>buildbuddy_remote_execution_runner_pool_evictions</code></strong> (Counter)<a class="hash-link" href="#buildbuddy_remote_execution_runner_pool_evictions-counter" title="Direct link to heading">â€‹</a></h3><p>Number of command runners removed from the pool to make room for other runners.</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_remote_execution_runner_pool_failed_recycle_attempts-counter"><strong><code>buildbuddy_remote_execution_runner_pool_failed_recycle_attempts</code></strong> (Counter)<a class="hash-link" href="#buildbuddy_remote_execution_runner_pool_failed_recycle_attempts-counter" title="Direct link to heading">â€‹</a></h3><p>Number of failed attempts to add runners to the pool.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="labels-21">Labels<a class="hash-link" href="#labels-21" title="Direct link to heading">â€‹</a></h4><ul><li><strong>reason</strong>: Reason for a runner not being added to the runner pool.</li></ul><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_remote_execution_runner_pool_memory_usage_bytes-gauge"><strong><code>buildbuddy_remote_execution_runner_pool_memory_usage_bytes</code></strong> (Gauge)<a class="hash-link" href="#buildbuddy_remote_execution_runner_pool_memory_usage_bytes-gauge" title="Direct link to heading">â€‹</a></h3><p>Total memory usage of pooled command runners, in <strong>bytes</strong>.</p><p>Currently only supported for Docker-based executors.</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_remote_execution_runner_pool_disk_usage_bytes-gauge"><strong><code>buildbuddy_remote_execution_runner_pool_disk_usage_bytes</code></strong> (Gauge)<a class="hash-link" href="#buildbuddy_remote_execution_runner_pool_disk_usage_bytes-gauge" title="Direct link to heading">â€‹</a></h3><p>Total disk usage of pooled command runners, in <strong>bytes</strong>.</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_remote_execution_file_cache_requests-counter"><strong><code>buildbuddy_remote_execution_file_cache_requests</code></strong> (Counter)<a class="hash-link" href="#buildbuddy_remote_execution_file_cache_requests-counter" title="Direct link to heading">â€‹</a></h3><p>Number of local executor file cache requests.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="labels-22">Labels<a class="hash-link" href="#labels-22" title="Direct link to heading">â€‹</a></h4><ul><li><strong>status</strong>: Status of the file cache request: <code>hit</code> if found in cache, <code>miss</code> otherwise.</li></ul><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_remote_execution_file_cache_last_eviction_age_usec-gauge"><strong><code>buildbuddy_remote_execution_file_cache_last_eviction_age_usec</code></strong> (Gauge)<a class="hash-link" href="#buildbuddy_remote_execution_file_cache_last_eviction_age_usec-gauge" title="Direct link to heading">â€‹</a></h3><p>Age of the last entry evicted from the executor&#x27;s local file cache (relative to when it was added to the cache), in <strong>microseconds</strong>.</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_remote_execution_file_cache_added_file_size_bytes-histogram"><strong><code>buildbuddy_remote_execution_file_cache_added_file_size_bytes</code></strong> (Histogram)<a class="hash-link" href="#buildbuddy_remote_execution_file_cache_added_file_size_bytes-histogram" title="Direct link to heading">â€‹</a></h3><p>Size of artifacts added to the file cache, in <strong>bytes</strong>.</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="blobstore-metrics">Blobstore metrics<a class="hash-link" href="#blobstore-metrics" title="Direct link to heading">â€‹</a></h2><p>&quot;Blobstore&quot; refers to the backing storage that BuildBuddy uses to
store objects in the cache, as well as certain pieces of temporary
data (such as invocation events while an invocation is in progress).</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_blobstore_read_count-counter"><strong><code>buildbuddy_blobstore_read_count</code></strong> (Counter)<a class="hash-link" href="#buildbuddy_blobstore_read_count-counter" title="Direct link to heading">â€‹</a></h3><p>Number of files read from the blobstore.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="labels-23">Labels<a class="hash-link" href="#labels-23" title="Direct link to heading">â€‹</a></h4><ul><li><strong>status</strong>: Status code as defined by <a href="https://godoc.org/google.golang.org/grpc/codes#Code" target="_blank" rel="noopener noreferrer">grpc/codes</a>. This is a numeric value; any non-zero code indicates an error.</li><li><strong>blobstore_type</strong>: <code>gcs</code> (Google Cloud Storage), <code>aws_s3</code>, or <code>disk</code>.</li></ul><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_blobstore_read_size_bytes-histogram"><strong><code>buildbuddy_blobstore_read_size_bytes</code></strong> (Histogram)<a class="hash-link" href="#buildbuddy_blobstore_read_size_bytes-histogram" title="Direct link to heading">â€‹</a></h3><p>Number of bytes read from the blobstore per file.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="labels-24">Labels<a class="hash-link" href="#labels-24" title="Direct link to heading">â€‹</a></h4><ul><li><strong>blobstore_type</strong>: <code>gcs</code> (Google Cloud Storage), <code>aws_s3</code>, or <code>disk</code>.</li></ul><div class="codeBlockContainer_K1bP language-promql theme-code-block"><div class="codeBlockContent_hGly promql"><pre tabindex="0" class="prism-code language-promql codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Bytes downloaded per second</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">sum(rate(buildbuddy_blobstore_read_size_bytes[5m]))</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_blobstore_read_duration_usec-histogram"><strong><code>buildbuddy_blobstore_read_duration_usec</code></strong> (Histogram)<a class="hash-link" href="#buildbuddy_blobstore_read_duration_usec-histogram" title="Direct link to heading">â€‹</a></h3><p>Duration per blobstore file read, in <strong>microseconds</strong>.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="labels-25">Labels<a class="hash-link" href="#labels-25" title="Direct link to heading">â€‹</a></h4><ul><li><strong>blobstore_type</strong>: <code>gcs</code> (Google Cloud Storage), <code>aws_s3</code>, or <code>disk</code>.</li></ul><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_blobstore_write_count-counter"><strong><code>buildbuddy_blobstore_write_count</code></strong> (Counter)<a class="hash-link" href="#buildbuddy_blobstore_write_count-counter" title="Direct link to heading">â€‹</a></h3><p>Number of files written to the blobstore.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="labels-26">Labels<a class="hash-link" href="#labels-26" title="Direct link to heading">â€‹</a></h4><ul><li><strong>status</strong>: Status code as defined by <a href="https://godoc.org/google.golang.org/grpc/codes#Code" target="_blank" rel="noopener noreferrer">grpc/codes</a>. This is a numeric value; any non-zero code indicates an error.</li><li><strong>blobstore_type</strong>: <code>gcs</code> (Google Cloud Storage), <code>aws_s3</code>, or <code>disk</code>.</li></ul><div class="codeBlockContainer_K1bP language-promql theme-code-block"><div class="codeBlockContent_hGly promql"><pre tabindex="0" class="prism-code language-promql codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Bytes uploaded per second</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">sum(rate(buildbuddy_blobstore_write_size_bytes[5m]))</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_blobstore_write_size_bytes-histogram"><strong><code>buildbuddy_blobstore_write_size_bytes</code></strong> (Histogram)<a class="hash-link" href="#buildbuddy_blobstore_write_size_bytes-histogram" title="Direct link to heading">â€‹</a></h3><p>Number of bytes written to the blobstore per file.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="labels-27">Labels<a class="hash-link" href="#labels-27" title="Direct link to heading">â€‹</a></h4><ul><li><strong>blobstore_type</strong>: <code>gcs</code> (Google Cloud Storage), <code>aws_s3</code>, or <code>disk</code>.</li></ul><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_blobstore_write_duration_usec-histogram"><strong><code>buildbuddy_blobstore_write_duration_usec</code></strong> (Histogram)<a class="hash-link" href="#buildbuddy_blobstore_write_duration_usec-histogram" title="Direct link to heading">â€‹</a></h3><p>Duration per blobstore file write, in <strong>microseconds</strong>.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="labels-28">Labels<a class="hash-link" href="#labels-28" title="Direct link to heading">â€‹</a></h4><ul><li><strong>blobstore_type</strong>: <code>gcs</code> (Google Cloud Storage), <code>aws_s3</code>, or <code>disk</code>.</li></ul><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_blobstore_delete_count-counter"><strong><code>buildbuddy_blobstore_delete_count</code></strong> (Counter)<a class="hash-link" href="#buildbuddy_blobstore_delete_count-counter" title="Direct link to heading">â€‹</a></h3><p>Number of files deleted from the blobstore.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="labels-29">Labels<a class="hash-link" href="#labels-29" title="Direct link to heading">â€‹</a></h4><ul><li><strong>status</strong>: Status code as defined by <a href="https://godoc.org/google.golang.org/grpc/codes#Code" target="_blank" rel="noopener noreferrer">grpc/codes</a>. This is a numeric value; any non-zero code indicates an error.</li><li><strong>blobstore_type</strong>: <code>gcs</code> (Google Cloud Storage), <code>aws_s3</code>, or <code>disk</code>.</li></ul><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_blobstore_delete_duration_usec-histogram"><strong><code>buildbuddy_blobstore_delete_duration_usec</code></strong> (Histogram)<a class="hash-link" href="#buildbuddy_blobstore_delete_duration_usec-histogram" title="Direct link to heading">â€‹</a></h3><p>Delete duration per blobstore file deletion, in <strong>microseconds</strong>.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="labels-30">Labels<a class="hash-link" href="#labels-30" title="Direct link to heading">â€‹</a></h4><ul><li><strong>blobstore_type</strong>: <code>gcs</code> (Google Cloud Storage), <code>aws_s3</code>, or <code>disk</code>.</li></ul><header><h1>SQL metrics</h1></header><p>The following metrics are for monitoring the SQL database configured
for BuildBuddy.</p><p>If you&#x27;d like to see an up-to-date catalog of what BuildBuddy stores in
its SQL database, see the table definitions <a href="https://github.com/buildbuddy-io/buildbuddy/blob/master/server/tables/tables.go" target="_blank" rel="noopener noreferrer">here</a>.</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="query--error-rate-metrics">Query / error rate metrics<a class="hash-link" href="#query--error-rate-metrics" title="Direct link to heading">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_sql_query_count-counter"><strong><code>buildbuddy_sql_query_count</code></strong> (Counter)<a class="hash-link" href="#buildbuddy_sql_query_count-counter" title="Direct link to heading">â€‹</a></h3><p>Number of SQL queries executed.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="labels-31">Labels<a class="hash-link" href="#labels-31" title="Direct link to heading">â€‹</a></h4><ul><li><strong>sql_query_template</strong>: SQL query before substituting template parameters.</li></ul><h4 class="anchor anchorWithStickyNavbar_31ik" id="examples-16">Examples<a class="hash-link" href="#examples-16" title="Direct link to heading">â€‹</a></h4><div class="codeBlockContainer_K1bP language-promql theme-code-block"><div class="codeBlockContent_hGly promql"><pre tabindex="0" class="prism-code language-promql codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># SQL queries per second (by query template).</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">sum by (sql_query_template) (rate(buildbuddy_sql_query_count[5m]))</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_sql_query_duration_usec-histogram"><strong><code>buildbuddy_sql_query_duration_usec</code></strong> (Histogram)<a class="hash-link" href="#buildbuddy_sql_query_duration_usec-histogram" title="Direct link to heading">â€‹</a></h3><p>SQL query duration, in <strong>microseconds</strong>.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="labels-32">Labels<a class="hash-link" href="#labels-32" title="Direct link to heading">â€‹</a></h4><ul><li><strong>sql_query_template</strong>: SQL query before substituting template parameters.</li></ul><h4 class="anchor anchorWithStickyNavbar_31ik" id="examples-17">Examples<a class="hash-link" href="#examples-17" title="Direct link to heading">â€‹</a></h4><div class="codeBlockContainer_K1bP language-promql theme-code-block"><div class="codeBlockContent_hGly promql"><pre tabindex="0" class="prism-code language-promql codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Median SQL query duration</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">histogram_quantile(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  0.5,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  sum(rate(buildbuddy_sql_query_duration_usec_bucket[5m])) by (le)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_sql_error_count-counter"><strong><code>buildbuddy_sql_error_count</code></strong> (Counter)<a class="hash-link" href="#buildbuddy_sql_error_count-counter" title="Direct link to heading">â€‹</a></h3><p>Number of SQL queries that resulted in an error.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="labels-33">Labels<a class="hash-link" href="#labels-33" title="Direct link to heading">â€‹</a></h4><ul><li><strong>sql_query_template</strong>: SQL query before substituting template parameters.</li></ul><h4 class="anchor anchorWithStickyNavbar_31ik" id="examples-18">Examples<a class="hash-link" href="#examples-18" title="Direct link to heading">â€‹</a></h4><div class="codeBlockContainer_K1bP language-promql theme-code-block"><div class="codeBlockContent_hGly promql"><pre tabindex="0" class="prism-code language-promql codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># SQL error rate</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">sum(rate(buildbuddy_sql_error_count[5m]))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  /</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">sum(rate(buildbuddy_sql_query_count[5m]))</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_31ik" id="databasesql-metrics"><code>database/sql</code> metrics<a class="hash-link" href="#databasesql-metrics" title="Direct link to heading">â€‹</a></h2><p>The following metrics directly expose
<a href="https://golang.org/pkg/database/sql/#DBStats" target="_blank" rel="noopener noreferrer">DBStats</a> from the
<code>database/sql</code> Go package.</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_sql_max_open_connections-gauge"><strong><code>buildbuddy_sql_max_open_connections</code></strong> (Gauge)<a class="hash-link" href="#buildbuddy_sql_max_open_connections-gauge" title="Direct link to heading">â€‹</a></h3><p>Maximum number of open connections to the database.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="labels-34">Labels<a class="hash-link" href="#labels-34" title="Direct link to heading">â€‹</a></h4><ul><li><strong>sql_db_role</strong>: SQL DB replica role: <code>primary</code> for read+write replicas, or <code>read_replica</code> for read-only DB replicas.</li></ul><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_sql_open_connections-gauge"><strong><code>buildbuddy_sql_open_connections</code></strong> (Gauge)<a class="hash-link" href="#buildbuddy_sql_open_connections-gauge" title="Direct link to heading">â€‹</a></h3><p>The number of established connections to the database.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="labels-35">Labels<a class="hash-link" href="#labels-35" title="Direct link to heading">â€‹</a></h4><ul><li><strong>connection_status</strong>: Status of the database connection: <code>in_use</code> or <code>idle</code></li><li><strong>sql_db_role</strong>: SQL DB replica role: <code>primary</code> for read+write replicas, or <code>read_replica</code> for read-only DB replicas.</li></ul><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_sql_wait_count-counter"><strong><code>buildbuddy_sql_wait_count</code></strong> (Counter)<a class="hash-link" href="#buildbuddy_sql_wait_count-counter" title="Direct link to heading">â€‹</a></h3><p>The total number of connections waited for.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="labels-36">Labels<a class="hash-link" href="#labels-36" title="Direct link to heading">â€‹</a></h4><ul><li><strong>sql_db_role</strong>: SQL DB replica role: <code>primary</code> for read+write replicas, or <code>read_replica</code> for read-only DB replicas.</li></ul><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_sql_wait_duration_usec-counter"><strong><code>buildbuddy_sql_wait_duration_usec</code></strong> (Counter)<a class="hash-link" href="#buildbuddy_sql_wait_duration_usec-counter" title="Direct link to heading">â€‹</a></h3><p>The total time blocked waiting for a new connection, in <strong>microseconds</strong>.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="labels-37">Labels<a class="hash-link" href="#labels-37" title="Direct link to heading">â€‹</a></h4><ul><li><strong>sql_db_role</strong>: SQL DB replica role: <code>primary</code> for read+write replicas, or <code>read_replica</code> for read-only DB replicas.</li></ul><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_sql_max_idle_closed-counter"><strong><code>buildbuddy_sql_max_idle_closed</code></strong> (Counter)<a class="hash-link" href="#buildbuddy_sql_max_idle_closed-counter" title="Direct link to heading">â€‹</a></h3><p>The total number of connections closed due to SetMaxIdleConns.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="labels-38">Labels<a class="hash-link" href="#labels-38" title="Direct link to heading">â€‹</a></h4><ul><li><strong>sql_db_role</strong>: SQL DB replica role: <code>primary</code> for read+write replicas, or <code>read_replica</code> for read-only DB replicas.</li></ul><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_sql_max_idle_time_closed-counter"><strong><code>buildbuddy_sql_max_idle_time_closed</code></strong> (Counter)<a class="hash-link" href="#buildbuddy_sql_max_idle_time_closed-counter" title="Direct link to heading">â€‹</a></h3><p>The total number of connections closed due to SetConnMaxIdleTime.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="labels-39">Labels<a class="hash-link" href="#labels-39" title="Direct link to heading">â€‹</a></h4><ul><li><strong>sql_db_role</strong>: SQL DB replica role: <code>primary</code> for read+write replicas, or <code>read_replica</code> for read-only DB replicas.</li></ul><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_sql_max_lifetime_closed-counter"><strong><code>buildbuddy_sql_max_lifetime_closed</code></strong> (Counter)<a class="hash-link" href="#buildbuddy_sql_max_lifetime_closed-counter" title="Direct link to heading">â€‹</a></h3><p>The total number of connections closed due to SetConnMaxLifetime.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="labels-40">Labels<a class="hash-link" href="#labels-40" title="Direct link to heading">â€‹</a></h4><ul><li><strong>sql_db_role</strong>: SQL DB replica role: <code>primary</code> for read+write replicas, or <code>read_replica</code> for read-only DB replicas.</li></ul><h2 class="anchor anchorWithStickyNavbar_31ik" id="http-metrics">HTTP metrics<a class="hash-link" href="#http-metrics" title="Direct link to heading">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_http_request_count-counter"><strong><code>buildbuddy_http_request_count</code></strong> (Counter)<a class="hash-link" href="#buildbuddy_http_request_count-counter" title="Direct link to heading">â€‹</a></h3><p>HTTP request count.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="labels-41">Labels<a class="hash-link" href="#labels-41" title="Direct link to heading">â€‹</a></h4><ul><li><strong>route</strong>: HTTP route before substituting path parameters (<code>/invocation/:id</code>, <code>/settings</code>, ...)</li><li><strong>method</strong>: HTTP method: <code>GET</code>, <code>POST</code>, ...</li></ul><h4 class="anchor anchorWithStickyNavbar_31ik" id="examples-19">Examples<a class="hash-link" href="#examples-19" title="Direct link to heading">â€‹</a></h4><div class="codeBlockContainer_K1bP language-promql theme-code-block"><div class="codeBlockContent_hGly promql"><pre tabindex="0" class="prism-code language-promql codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Requests per second, by status code</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">sum by (code) (rate(buildbuddy_http_request_count[5m]))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># 5xx error ratio</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">sum(rate(buildbuddy_http_request_count{code=~&quot;5..&quot;}[5m]))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  /</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">sum(rate(buildbuddy_http_request_count[5m]))</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_http_request_handler_duration_usec-histogram"><strong><code>buildbuddy_http_request_handler_duration_usec</code></strong> (Histogram)<a class="hash-link" href="#buildbuddy_http_request_handler_duration_usec-histogram" title="Direct link to heading">â€‹</a></h3><p>Time taken to handle each HTTP request in <strong>microseconds</strong>.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="labels-42">Labels<a class="hash-link" href="#labels-42" title="Direct link to heading">â€‹</a></h4><ul><li><strong>route</strong>: HTTP route before substituting path parameters (<code>/invocation/:id</code>, <code>/settings</code>, ...)</li><li><strong>method</strong>: HTTP method: <code>GET</code>, <code>POST</code>, ...</li><li><strong>code</strong>: HTTP response code: <code>200</code>, <code>302</code>, <code>401</code>, <code>404</code>, <code>500</code>, ...</li></ul><h4 class="anchor anchorWithStickyNavbar_31ik" id="examples-20">Examples<a class="hash-link" href="#examples-20" title="Direct link to heading">â€‹</a></h4><div class="codeBlockContainer_K1bP language-promql theme-code-block"><div class="codeBlockContent_hGly promql"><pre tabindex="0" class="prism-code language-promql codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Median request duration for successfuly processed (2xx) requests.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Other status codes may be associated with early-exits and are</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># likely to add too much noise.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">histogram_quantile(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  0.5,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  sum by (le)   (rate(buildbuddy_http_request_handler_duration_usec{code=~&quot;2..&quot;}[5m]))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_http_response_size_bytes-histogram"><strong><code>buildbuddy_http_response_size_bytes</code></strong> (Histogram)<a class="hash-link" href="#buildbuddy_http_response_size_bytes-histogram" title="Direct link to heading">â€‹</a></h3><p>Response size of each HTTP response in <strong>bytes</strong>.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="labels-43">Labels<a class="hash-link" href="#labels-43" title="Direct link to heading">â€‹</a></h4><ul><li><strong>route</strong>: HTTP route before substituting path parameters (<code>/invocation/:id</code>, <code>/settings</code>, ...)</li><li><strong>method</strong>: HTTP method: <code>GET</code>, <code>POST</code>, ...</li><li><strong>code</strong>: HTTP response code: <code>200</code>, <code>302</code>, <code>401</code>, <code>404</code>, <code>500</code>, ...</li></ul><h4 class="anchor anchorWithStickyNavbar_31ik" id="examples-21">Examples<a class="hash-link" href="#examples-21" title="Direct link to heading">â€‹</a></h4><div class="codeBlockContainer_K1bP language-promql theme-code-block"><div class="codeBlockContent_hGly promql"><pre tabindex="0" class="prism-code language-promql codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Median HTTP response size</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">histogram_quantile(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  0.5,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  sum by (le)   (rate(buildbuddy_http_response_size_bytes[5m]))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_31ik" id="internal-metrics">Internal metrics<a class="hash-link" href="#internal-metrics" title="Direct link to heading">â€‹</a></h2><p>These metrics are for monitoring lower-level subsystems of BuildBuddy.</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="build-event-handler">Build event handler<a class="hash-link" href="#build-event-handler" title="Direct link to heading">â€‹</a></h3><p>The build event handler logs all build events uploaded to BuildBuddy
as part of the Build Event Protocol.</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_build_event_handler_duration_usec-histogram"><strong><code>buildbuddy_build_event_handler_duration_usec</code></strong> (Histogram)<a class="hash-link" href="#buildbuddy_build_event_handler_duration_usec-histogram" title="Direct link to heading">â€‹</a></h3><p>The time spent handling each build event in <strong>microseconds</strong>.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="labels-44">Labels<a class="hash-link" href="#labels-44" title="Direct link to heading">â€‹</a></h4><ul><li><strong>status</strong>: Status code as defined by <a href="https://godoc.org/google.golang.org/grpc/codes#Code" target="_blank" rel="noopener noreferrer">grpc/codes</a>. This is a numeric value; any non-zero code indicates an error.</li></ul><h3 class="anchor anchorWithStickyNavbar_31ik" id="webhooks">Webhooks<a class="hash-link" href="#webhooks" title="Direct link to heading">â€‹</a></h3><p>Webhooks are HTTP endpoints exposed by BuildBuddy server which allow it to
respond to repository events. These URLs are created as part of BuildBuddy
workflows.</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_webhook_handler_workflows_started-counter"><strong><code>buildbuddy_webhook_handler_workflows_started</code></strong> (Counter)<a class="hash-link" href="#buildbuddy_webhook_handler_workflows_started-counter" title="Direct link to heading">â€‹</a></h3><p>The number of workflows triggered by the webhook handler.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="labels-45">Labels<a class="hash-link" href="#labels-45" title="Direct link to heading">â€‹</a></h4><ul><li><strong>event</strong>: Type of event sent to BuildBuddy&#x27;s webhook handler: <code>push</code> or <code>pull_request</code>.</li></ul><h3 class="anchor anchorWithStickyNavbar_31ik" id="cache">Cache<a class="hash-link" href="#cache" title="Direct link to heading">â€‹</a></h3><p>&quot;Cache&quot; refers to the cache backend(s) that BuildBuddy uses to
accelerate file IO operations, which are common in different
subsystems such as the remote cache and the fetch server (for
downloading invocation artifacts).</p><p>BuildBuddy can be configured to use multiple layers of caching
(an in-memory layer, coupled with a cloud storage layer).</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="get-metrics"><code>get</code> metrics<a class="hash-link" href="#get-metrics" title="Direct link to heading">â€‹</a></h4><p><code>get</code> metrics track non-streamed cache reads (all data is fetched
from the cache in a single request).</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_cache_get_count-counter"><strong><code>buildbuddy_cache_get_count</code></strong> (Counter)<a class="hash-link" href="#buildbuddy_cache_get_count-counter" title="Direct link to heading">â€‹</a></h3><p>Number of cache get requests.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="labels-46">Labels<a class="hash-link" href="#labels-46" title="Direct link to heading">â€‹</a></h4><ul><li><strong>status</strong>: Status code as defined by <a href="https://godoc.org/google.golang.org/grpc/codes#Code" target="_blank" rel="noopener noreferrer">grpc/codes</a>. This is a numeric value; any non-zero code indicates an error.</li><li><strong>tier</strong>: Cache tier: <code>memory</code> or <code>cloud</code>. This label can be used to write Prometheus queries that don&#x27;t break if the cache backend is swapped out for a different backend.</li><li><strong>backend</strong>: Cache backend: <code>gcs</code> (Google Cloud Storage), <code>aws_s3</code>, or <code>redis</code>.</li></ul><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_cache_get_duration_usec-histogram"><strong><code>buildbuddy_cache_get_duration_usec</code></strong> (Histogram)<a class="hash-link" href="#buildbuddy_cache_get_duration_usec-histogram" title="Direct link to heading">â€‹</a></h3><p>The time spent retrieving each entry from the cache, in <strong>microseconds</strong>.</p><p>This is recorded only for successful gets.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="labels-47">Labels<a class="hash-link" href="#labels-47" title="Direct link to heading">â€‹</a></h4><ul><li><strong>tier</strong>: Cache tier: <code>memory</code> or <code>cloud</code>. This label can be used to write Prometheus queries that don&#x27;t break if the cache backend is swapped out for a different backend.</li><li><strong>backend</strong>: Cache backend: <code>gcs</code> (Google Cloud Storage), <code>aws_s3</code>, or <code>redis</code>.</li></ul><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_cache_get_size_bytes-histogram"><strong><code>buildbuddy_cache_get_size_bytes</code></strong> (Histogram)<a class="hash-link" href="#buildbuddy_cache_get_size_bytes-histogram" title="Direct link to heading">â€‹</a></h3><p>Size of each entry retrieved from the cache, in <strong>bytes</strong>.</p><p>This is recorded only for successful gets.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="labels-48">Labels<a class="hash-link" href="#labels-48" title="Direct link to heading">â€‹</a></h4><ul><li><strong>tier</strong>: Cache tier: <code>memory</code> or <code>cloud</code>. This label can be used to write Prometheus queries that don&#x27;t break if the cache backend is swapped out for a different backend.</li><li><strong>backend</strong>: Cache backend: <code>gcs</code> (Google Cloud Storage), <code>aws_s3</code>, or <code>redis</code>.</li></ul><h4 class="anchor anchorWithStickyNavbar_31ik" id="read-metrics"><code>read</code> metrics<a class="hash-link" href="#read-metrics" title="Direct link to heading">â€‹</a></h4><p><code>read</code> metrics track streamed cache reads.</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_cache_read_count-counter"><strong><code>buildbuddy_cache_read_count</code></strong> (Counter)<a class="hash-link" href="#buildbuddy_cache_read_count-counter" title="Direct link to heading">â€‹</a></h3><p>Number of streamed cache reads started.</p><p>This is incremented once for each started stream, <strong>not</strong> for each chunk in the stream.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="labels-49">Labels<a class="hash-link" href="#labels-49" title="Direct link to heading">â€‹</a></h4><ul><li><strong>status</strong>: Status code as defined by <a href="https://godoc.org/google.golang.org/grpc/codes#Code" target="_blank" rel="noopener noreferrer">grpc/codes</a>. This is a numeric value; any non-zero code indicates an error.</li><li><strong>tier</strong>: Cache tier: <code>memory</code> or <code>cloud</code>. This label can be used to write Prometheus queries that don&#x27;t break if the cache backend is swapped out for a different backend.</li><li><strong>backend</strong>: Cache backend: <code>gcs</code> (Google Cloud Storage), <code>aws_s3</code>, or <code>redis</code>.</li></ul><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_cache_read_duration_usec-histogram"><strong><code>buildbuddy_cache_read_duration_usec</code></strong> (Histogram)<a class="hash-link" href="#buildbuddy_cache_read_duration_usec-histogram" title="Direct link to heading">â€‹</a></h3><p>The total time spent for each read stream, in <strong>microseconds</strong>.</p><p>This is recorded only for successful reads, and measures the entire read stream (not just individual chunks).</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="labels-50">Labels<a class="hash-link" href="#labels-50" title="Direct link to heading">â€‹</a></h4><ul><li><strong>tier</strong>: Cache tier: <code>memory</code> or <code>cloud</code>. This label can be used to write Prometheus queries that don&#x27;t break if the cache backend is swapped out for a different backend.</li><li><strong>backend</strong>: Cache backend: <code>gcs</code> (Google Cloud Storage), <code>aws_s3</code>, or <code>redis</code>.</li></ul><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_cache_read_size_bytes-histogram"><strong><code>buildbuddy_cache_read_size_bytes</code></strong> (Histogram)<a class="hash-link" href="#buildbuddy_cache_read_size_bytes-histogram" title="Direct link to heading">â€‹</a></h3><p>Total size of each entry retrieved from the cache via streaming, in <strong>bytes</strong>.</p><p>This is recorded only on success, and measures the entire stream (not just individual chunks).</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="labels-51">Labels<a class="hash-link" href="#labels-51" title="Direct link to heading">â€‹</a></h4><ul><li><strong>tier</strong>: Cache tier: <code>memory</code> or <code>cloud</code>. This label can be used to write Prometheus queries that don&#x27;t break if the cache backend is swapped out for a different backend.</li><li><strong>backend</strong>: Cache backend: <code>gcs</code> (Google Cloud Storage), <code>aws_s3</code>, or <code>redis</code>.</li></ul><h4 class="anchor anchorWithStickyNavbar_31ik" id="set-metrics"><code>set</code> metrics<a class="hash-link" href="#set-metrics" title="Direct link to heading">â€‹</a></h4><p><code>set</code> metrics track non-streamed cache writes (all data is wrtiten
in a single request).</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_cache_set_count-counter"><strong><code>buildbuddy_cache_set_count</code></strong> (Counter)<a class="hash-link" href="#buildbuddy_cache_set_count-counter" title="Direct link to heading">â€‹</a></h3><p>Number of cache set requests.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="labels-52">Labels<a class="hash-link" href="#labels-52" title="Direct link to heading">â€‹</a></h4><ul><li><strong>status</strong>: Status code as defined by <a href="https://godoc.org/google.golang.org/grpc/codes#Code" target="_blank" rel="noopener noreferrer">grpc/codes</a>. This is a numeric value; any non-zero code indicates an error.</li><li><strong>tier</strong>: Cache tier: <code>memory</code> or <code>cloud</code>. This label can be used to write Prometheus queries that don&#x27;t break if the cache backend is swapped out for a different backend.</li><li><strong>backend</strong>: Cache backend: <code>gcs</code> (Google Cloud Storage), <code>aws_s3</code>, or <code>redis</code>.</li></ul><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_cache_set_duration_usec-histogram"><strong><code>buildbuddy_cache_set_duration_usec</code></strong> (Histogram)<a class="hash-link" href="#buildbuddy_cache_set_duration_usec-histogram" title="Direct link to heading">â€‹</a></h3><p>The time spent writing each entry to the cache, in <strong>microseconds</strong>.</p><p>This is recorded only for successful sets.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="labels-53">Labels<a class="hash-link" href="#labels-53" title="Direct link to heading">â€‹</a></h4><ul><li><strong>tier</strong>: Cache tier: <code>memory</code> or <code>cloud</code>. This label can be used to write Prometheus queries that don&#x27;t break if the cache backend is swapped out for a different backend.</li><li><strong>backend</strong>: Cache backend: <code>gcs</code> (Google Cloud Storage), <code>aws_s3</code>, or <code>redis</code>.</li></ul><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_cache_set_size_bytes-histogram"><strong><code>buildbuddy_cache_set_size_bytes</code></strong> (Histogram)<a class="hash-link" href="#buildbuddy_cache_set_size_bytes-histogram" title="Direct link to heading">â€‹</a></h3><p>Size of the value stored in each set operation, in <strong>bytes</strong>.</p><p>This is recorded only for successful sets.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="labels-54">Labels<a class="hash-link" href="#labels-54" title="Direct link to heading">â€‹</a></h4><ul><li><strong>tier</strong>: Cache tier: <code>memory</code> or <code>cloud</code>. This label can be used to write Prometheus queries that don&#x27;t break if the cache backend is swapped out for a different backend.</li><li><strong>backend</strong>: Cache backend: <code>gcs</code> (Google Cloud Storage), <code>aws_s3</code>, or <code>redis</code>.</li></ul><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_cache_set_retries-histogram"><strong><code>buildbuddy_cache_set_retries</code></strong> (Histogram)<a class="hash-link" href="#buildbuddy_cache_set_retries-histogram" title="Direct link to heading">â€‹</a></h3><p>Number of retries required to fulfill the set request (an observed value of 0 means the transfer succeeded on the first try).</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="labels-55">Labels<a class="hash-link" href="#labels-55" title="Direct link to heading">â€‹</a></h4><ul><li><strong>tier</strong>: Cache tier: <code>memory</code> or <code>cloud</code>. This label can be used to write Prometheus queries that don&#x27;t break if the cache backend is swapped out for a different backend.</li><li><strong>backend</strong>: Cache backend: <code>gcs</code> (Google Cloud Storage), <code>aws_s3</code>, or <code>redis</code>.</li></ul><h4 class="anchor anchorWithStickyNavbar_31ik" id="write-metrics"><code>write</code> metrics<a class="hash-link" href="#write-metrics" title="Direct link to heading">â€‹</a></h4><p><code>write</code> metrics track streamed cache writes.</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_cache_write_count-counter"><strong><code>buildbuddy_cache_write_count</code></strong> (Counter)<a class="hash-link" href="#buildbuddy_cache_write_count-counter" title="Direct link to heading">â€‹</a></h3><p>Number of streamed cache writes started.</p><p>This is incremented once for each started stream, <strong>not</strong> for each chunk in the stream.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="labels-56">Labels<a class="hash-link" href="#labels-56" title="Direct link to heading">â€‹</a></h4><ul><li><strong>status</strong>: Status code as defined by <a href="https://godoc.org/google.golang.org/grpc/codes#Code" target="_blank" rel="noopener noreferrer">grpc/codes</a>. This is a numeric value; any non-zero code indicates an error.</li><li><strong>tier</strong>: Cache tier: <code>memory</code> or <code>cloud</code>. This label can be used to write Prometheus queries that don&#x27;t break if the cache backend is swapped out for a different backend.</li><li><strong>backend</strong>: Cache backend: <code>gcs</code> (Google Cloud Storage), <code>aws_s3</code>, or <code>redis</code>.</li></ul><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_cache_write_duration_usec-histogram"><strong><code>buildbuddy_cache_write_duration_usec</code></strong> (Histogram)<a class="hash-link" href="#buildbuddy_cache_write_duration_usec-histogram" title="Direct link to heading">â€‹</a></h3><p>The time spent for each streamed write to the cache, in <strong>microseconds</strong>.</p><p>This is recorded only on success, and measures the entire stream (not just individual chunks).</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="labels-57">Labels<a class="hash-link" href="#labels-57" title="Direct link to heading">â€‹</a></h4><ul><li><strong>tier</strong>: Cache tier: <code>memory</code> or <code>cloud</code>. This label can be used to write Prometheus queries that don&#x27;t break if the cache backend is swapped out for a different backend.</li><li><strong>backend</strong>: Cache backend: <code>gcs</code> (Google Cloud Storage), <code>aws_s3</code>, or <code>redis</code>.</li></ul><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_cache_write_size_bytes-histogram"><strong><code>buildbuddy_cache_write_size_bytes</code></strong> (Histogram)<a class="hash-link" href="#buildbuddy_cache_write_size_bytes-histogram" title="Direct link to heading">â€‹</a></h3><p>Size of each entry written to the cache via streaming, in <strong>bytes</strong>.</p><p>This is recorded only on success, and measures the entire stream (not just individual chunks).</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="labels-58">Labels<a class="hash-link" href="#labels-58" title="Direct link to heading">â€‹</a></h4><ul><li><strong>tier</strong>: Cache tier: <code>memory</code> or <code>cloud</code>. This label can be used to write Prometheus queries that don&#x27;t break if the cache backend is swapped out for a different backend.</li><li><strong>backend</strong>: Cache backend: <code>gcs</code> (Google Cloud Storage), <code>aws_s3</code>, or <code>redis</code>.</li></ul><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_cache_write_retries-histogram"><strong><code>buildbuddy_cache_write_retries</code></strong> (Histogram)<a class="hash-link" href="#buildbuddy_cache_write_retries-histogram" title="Direct link to heading">â€‹</a></h3><p>Number of retries required to write each chunk in the stream (an observed value of 0 means the transfer succeeded on the first try).</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="labels-59">Labels<a class="hash-link" href="#labels-59" title="Direct link to heading">â€‹</a></h4><ul><li><strong>tier</strong>: Cache tier: <code>memory</code> or <code>cloud</code>. This label can be used to write Prometheus queries that don&#x27;t break if the cache backend is swapped out for a different backend.</li><li><strong>backend</strong>: Cache backend: <code>gcs</code> (Google Cloud Storage), <code>aws_s3</code>, or <code>redis</code>.</li></ul><h3 class="anchor anchorWithStickyNavbar_31ik" id="other-cache-metrics">Other cache metrics<a class="hash-link" href="#other-cache-metrics" title="Direct link to heading">â€‹</a></h3><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_cache_delete_count-counter"><strong><code>buildbuddy_cache_delete_count</code></strong> (Counter)<a class="hash-link" href="#buildbuddy_cache_delete_count-counter" title="Direct link to heading">â€‹</a></h3><p>Number of deletes from the cache.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="labels-60">Labels<a class="hash-link" href="#labels-60" title="Direct link to heading">â€‹</a></h4><ul><li><strong>status</strong>: Status code as defined by <a href="https://godoc.org/google.golang.org/grpc/codes#Code" target="_blank" rel="noopener noreferrer">grpc/codes</a>. This is a numeric value; any non-zero code indicates an error.</li><li><strong>tier</strong>: Cache tier: <code>memory</code> or <code>cloud</code>. This label can be used to write Prometheus queries that don&#x27;t break if the cache backend is swapped out for a different backend.</li><li><strong>backend</strong>: Cache backend: <code>gcs</code> (Google Cloud Storage), <code>aws_s3</code>, or <code>redis</code>.</li></ul><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_cache_delete_duration_usec-histogram"><strong><code>buildbuddy_cache_delete_duration_usec</code></strong> (Histogram)<a class="hash-link" href="#buildbuddy_cache_delete_duration_usec-histogram" title="Direct link to heading">â€‹</a></h3><p>Duration of each cache deletion, in <strong>microseconds</strong>.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="labels-61">Labels<a class="hash-link" href="#labels-61" title="Direct link to heading">â€‹</a></h4><ul><li><strong>tier</strong>: Cache tier: <code>memory</code> or <code>cloud</code>. This label can be used to write Prometheus queries that don&#x27;t break if the cache backend is swapped out for a different backend.</li><li><strong>backend</strong>: Cache backend: <code>gcs</code> (Google Cloud Storage), <code>aws_s3</code>, or <code>redis</code>.</li></ul><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_cache_contains_count-counter"><strong><code>buildbuddy_cache_contains_count</code></strong> (Counter)<a class="hash-link" href="#buildbuddy_cache_contains_count-counter" title="Direct link to heading">â€‹</a></h3><p>Number of <code>contains(key)</code> requests made to the cache.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="labels-62">Labels<a class="hash-link" href="#labels-62" title="Direct link to heading">â€‹</a></h4><ul><li><strong>status</strong>: Status code as defined by <a href="https://godoc.org/google.golang.org/grpc/codes#Code" target="_blank" rel="noopener noreferrer">grpc/codes</a>. This is a numeric value; any non-zero code indicates an error.</li><li><strong>tier</strong>: Cache tier: <code>memory</code> or <code>cloud</code>. This label can be used to write Prometheus queries that don&#x27;t break if the cache backend is swapped out for a different backend.</li><li><strong>backend</strong>: Cache backend: <code>gcs</code> (Google Cloud Storage), <code>aws_s3</code>, or <code>redis</code>.</li></ul><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_cache_contains_duration_usec-histogram"><strong><code>buildbuddy_cache_contains_duration_usec</code></strong> (Histogram)<a class="hash-link" href="#buildbuddy_cache_contains_duration_usec-histogram" title="Direct link to heading">â€‹</a></h3><p>Duration of each each <code>contains(key)</code> request, in <strong>microseconds</strong>.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="labels-63">Labels<a class="hash-link" href="#labels-63" title="Direct link to heading">â€‹</a></h4><ul><li><strong>tier</strong>: Cache tier: <code>memory</code> or <code>cloud</code>. This label can be used to write Prometheus queries that don&#x27;t break if the cache backend is swapped out for a different backend.</li><li><strong>backend</strong>: Cache backend: <code>gcs</code> (Google Cloud Storage), <code>aws_s3</code>, or <code>redis</code>.</li></ul><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_cache_contains_retry_count-histogram"><strong><code>buildbuddy_cache_contains_retry_count</code></strong> (Histogram)<a class="hash-link" href="#buildbuddy_cache_contains_retry_count-histogram" title="Direct link to heading">â€‹</a></h3><p>Number of retries required to fulfill each <code>contains(key)</code> request to the cache (an observed value of 0 means the request succeeded on the first try).</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="labels-64">Labels<a class="hash-link" href="#labels-64" title="Direct link to heading">â€‹</a></h4><ul><li><strong>tier</strong>: Cache tier: <code>memory</code> or <code>cloud</code>. This label can be used to write Prometheus queries that don&#x27;t break if the cache backend is swapped out for a different backend.</li><li><strong>backend</strong>: Cache backend: <code>gcs</code> (Google Cloud Storage), <code>aws_s3</code>, or <code>redis</code>.</li></ul><h3 class="anchor anchorWithStickyNavbar_31ik" id="misc-metrics">Misc metrics<a class="hash-link" href="#misc-metrics" title="Direct link to heading">â€‹</a></h3><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_unexpected_event-counter"><strong><code>buildbuddy_unexpected_event</code></strong> (Counter)<a class="hash-link" href="#buildbuddy_unexpected_event-counter" title="Direct link to heading">â€‹</a></h3><p>Counter for unexpected events.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="labels-65">Labels<a class="hash-link" href="#labels-65" title="Direct link to heading">â€‹</a></h4><ul><li><strong>name</strong>: The name used to identify the type of an unexpected event.</li></ul><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_quota_rpcs_handled_total_by_quota_key-counter"><strong><code>buildbuddy_quota_rpcs_handled_total_by_quota_key</code></strong> (Counter)<a class="hash-link" href="#buildbuddy_quota_rpcs_handled_total_by_quota_key-counter" title="Direct link to heading">â€‹</a></h3><p>Total number of RPCs completed on the server by quota_key, regardless of success or failure.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="labels-66">Labels<a class="hash-link" href="#labels-66" title="Direct link to heading">â€‹</a></h4><ul><li><strong>grpc_full_method</strong>: The full name of the grpc method: <code>/&lt;service&gt;/&lt;method&gt;</code></li><li><strong>quota_key</strong>: The key used for quota accounting, either a group ID or an IP address.</li><li><strong>quota_allowed</strong>: Whether the request was allowed by quota manager.</li></ul><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_registry_blob_range_latency_usec-histogram"><strong><code>buildbuddy_registry_blob_range_latency_usec</code></strong> (Histogram)<a class="hash-link" href="#buildbuddy_registry_blob_range_latency_usec-histogram" title="Direct link to heading">â€‹</a></h3><p>Latency of serving layer blob ranges.</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_clickhouse_insert_count-counter"><strong><code>buildbuddy_clickhouse_insert_count</code></strong> (Counter)<a class="hash-link" href="#buildbuddy_clickhouse_insert_count-counter" title="Direct link to heading">â€‹</a></h3><p>Num of rows inserted into clickhouse</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="labels-67">Labels<a class="hash-link" href="#labels-67" title="Direct link to heading">â€‹</a></h4><ul><li><strong>clickhouse_table_name</strong>: The name of the table in Clickhouse</li><li><strong>status</strong>: Status of the Clickhouse operation: <code>ok</code>, <code>error</code>.</li></ul><h3 class="anchor anchorWithStickyNavbar_31ik" id="raft-cache-metrics">Raft cache metrics<a class="hash-link" href="#raft-cache-metrics" title="Direct link to heading">â€‹</a></h3><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_raft_ranges-gauge"><strong><code>buildbuddy_raft_ranges</code></strong> (Gauge)<a class="hash-link" href="#buildbuddy_raft_ranges-gauge" title="Direct link to heading">â€‹</a></h3><p>Number of raft ranges on each nodehost.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="labels-68">Labels<a class="hash-link" href="#labels-68" title="Direct link to heading">â€‹</a></h4><ul><li><strong>node_host_id</strong>: The ID of a raft nodehost.</li></ul><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_raft_records-gauge"><strong><code>buildbuddy_raft_records</code></strong> (Gauge)<a class="hash-link" href="#buildbuddy_raft_records-gauge" title="Direct link to heading">â€‹</a></h3><p>Number of raft records in each range.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="labels-69">Labels<a class="hash-link" href="#labels-69" title="Direct link to heading">â€‹</a></h4><ul><li><strong>range_id</strong>: The range ID of a raft region.</li></ul><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_raft_bytes-gauge"><strong><code>buildbuddy_raft_bytes</code></strong> (Gauge)<a class="hash-link" href="#buildbuddy_raft_bytes-gauge" title="Direct link to heading">â€‹</a></h3><p>Size (in bytes) of each range.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="labels-70">Labels<a class="hash-link" href="#labels-70" title="Direct link to heading">â€‹</a></h4><ul><li><strong>range_id</strong>: The range ID of a raft region.</li></ul><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_raft_proposals-counter"><strong><code>buildbuddy_raft_proposals</code></strong> (Counter)<a class="hash-link" href="#buildbuddy_raft_proposals-counter" title="Direct link to heading">â€‹</a></h3><p>The total number of statemachine proposals on each range.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="labels-71">Labels<a class="hash-link" href="#labels-71" title="Direct link to heading">â€‹</a></h4><ul><li><strong>range_id</strong>: The range ID of a raft region.</li></ul><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_raft_splits-counter"><strong><code>buildbuddy_raft_splits</code></strong> (Counter)<a class="hash-link" href="#buildbuddy_raft_splits-counter" title="Direct link to heading">â€‹</a></h3><p>The total number of splits per nodehost.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="labels-72">Labels<a class="hash-link" href="#labels-72" title="Direct link to heading">â€‹</a></h4><ul><li><strong>node_host_id</strong>: The ID of a raft nodehost.</li></ul><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_raft_moves-counter"><strong><code>buildbuddy_raft_moves</code></strong> (Counter)<a class="hash-link" href="#buildbuddy_raft_moves-counter" title="Direct link to heading">â€‹</a></h3><p>The total number of moves per nodehost.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="labels-73">Labels<a class="hash-link" href="#labels-73" title="Direct link to heading">â€‹</a></h4><ul><li><strong>node_host_id</strong>: The ID of a raft nodehost.</li><li><strong>move_type</strong>: The type of raft move <code>add</code>, or <code>remove</code>.</li></ul><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_raft_rangecache_lookups-counter"><strong><code>buildbuddy_raft_rangecache_lookups</code></strong> (Counter)<a class="hash-link" href="#buildbuddy_raft_rangecache_lookups-counter" title="Direct link to heading">â€‹</a></h3><p>The total number of rangecache lookups per nodehost.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="labels-74">Labels<a class="hash-link" href="#labels-74" title="Direct link to heading">â€‹</a></h4><ul><li><strong>rangecache_event_type</strong>: Raft RangeCache event type: <code>hit</code>, <code>miss</code>, or <code>update</code>.</li></ul><h3 class="anchor anchorWithStickyNavbar_31ik" id="buildbuddy_raft_split_duration_usec-histogram"><strong><code>buildbuddy_raft_split_duration_usec</code></strong> (Histogram)<a class="hash-link" href="#buildbuddy_raft_split_duration_usec-histogram" title="Direct link to heading">â€‹</a></h3><p>The time spent splitting a range in <strong>microseconds</strong>.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="labels-75">Labels<a class="hash-link" href="#labels-75" title="Direct link to heading">â€‹</a></h4><ul><li><strong>range_id</strong>: The range ID of a raft region.</li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/buildbuddy-io/buildbuddy/edit/master/docs/../docs/prometheus-metrics.mdx" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_13-_"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2022-11-11T22:03:42.000Z">11/11/2022</time></b> by <b>Brandon Duffany</b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/enterprise-api"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Enterprise API</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/architecture-overview"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Architecture Overview</div></a></div></nav></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title"></div><ul class="footer__items"><li class="footer__item"><a href="/"><img alt="BuildBuddy Logo" src="/img/logo_white.svg" width="281px" height="32px" class="footer-logo"></a></li></ul></div><div class="col footer__col"><div class="footer__title">Product</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" target="_self" href="/ui">Build &amp; Test UI</a></li><li class="footer__item"><a class="footer__link-item" target="_self" href="/remote-execution">Remote Execution</a></li><li class="footer__item"><a class="footer__link-item" target="_self" href="/remote-cache">Remote Cache</a></li><li class="footer__item"><a href="https://app.buildbuddy.io" target="_self" rel="noopener noreferrer" class="footer__link-item"><span>Get Started<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a class="footer__link-item" target="_self" href="/docs/introduction/">Documentation</a></li><li class="footer__item"><a class="footer__link-item" target="_self" href="/pricing">Pricing</a></li><li class="footer__item"><a href="https://app.buildbuddy.io/" target="_self" rel="noopener noreferrer" class="footer__link-item"><span>Login<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a class="footer__link-item" target="_self" href="/privacy">Privacy Policy</a></li><li class="footer__item"><a class="footer__link-item" target="_self" href="/terms">Terms of Service</a></li></ul></div><div class="col footer__col"><div class="footer__title">Company</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" target="_self" href="/blog/">Blog</a></li><li class="footer__item"><a href="https://github.com/buildbuddy-io/buildbuddy/issues/new" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Report an Issue<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a class="footer__link-item" target="_self" href="/contact">Contact Us</a></li><li class="footer__item"><a class="footer__link-item" target="_self" href="/team">Team</a></li><li class="footer__item"><a class="footer__link-item" target="_self" href="/careers">Careers</a></li></ul></div><div class="col footer__col"><div class="footer__title">Security</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" target="_self" href="/security">Security Overview</a></li><li class="footer__item"><a class="footer__link-item" target="_self" href="/security-updates">Security Updates</a></li><li class="footer__item"><a class="footer__link-item" target="_self" href="/security-vulnerability-report">Report a Vulnerability</a></li></ul></div><div class="col footer__col"><div class="footer__title">Connect</div><ul class="footer__items"><li class="footer__item"><a href="http://slack.buildbuddy.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Slack<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://twitter.com/buildbuddy_io" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="http://linkedin.com/company/buildbuddy" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://github.com/buildbuddy-io" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Â© 2022 Iteration, Inc.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.1a39789c.js"></script>
<script src="/assets/js/main.d8c0b957.js"></script>
</body>
</html>